{
  "version": 4,
  "terraform_version": "1.2.6",
  "serial": 61,
  "lineage": "5676ed79-c769-b65a-d1a7-310d1cd5b9fb",
  "outputs": {},
  "resources": [
    {
      "module": "module.policy_assignments",
      "mode": "data",
      "type": "azurerm_resource_group",
      "name": "rggroup",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/19a7ed62-f51f-4e53-b3ea-6ba9a63f17fe/resourceGroups/rg-avs-migrate-manage-kcl-westus2-001",
            "location": "westus2",
            "name": "rg-avs-migrate-manage-kcl-westus2-001",
            "tags": {
              "accountid": "cloud",
              "category": "kyndrylplay",
              "country": "USA",
              "funding": "mjil",
              "owner": "sunil.bhatia@kyndryl.com, ramprasad.s@kyndryl.com",
              "practice": "cloud",
              "teamorproject": "CCoE-AVS-OfferingDevelopment",
              "usecase": "Seamlessly move VMware-based workloads from your datacenter to Azure and integrate your VMware environment with Azure. Keep managing your existing environments with the same VMware tools you already know while you modernize your applications with Azure"
            },
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.policy_assignments",
      "mode": "data",
      "type": "azurerm_subscription",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "display_name": "DEV-crp-cio-hst-MJIL-CLDPRTC-11111",
            "id": "/subscriptions/19a7ed62-f51f-4e53-b3ea-6ba9a63f17fe",
            "location_placement_id": "Public_2014-09-01",
            "quota_id": "EnterpriseAgreement_2014-09-01",
            "spending_limit": "Off",
            "state": "Enabled",
            "subscription_id": "19a7ed62-f51f-4e53-b3ea-6ba9a63f17fe",
            "tags": {},
            "tenant_id": "d1c719f7-cc48-4f9f-83ec-f706a2a940fe",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.policy_assignments",
      "mode": "managed",
      "type": "azurerm_resource_group_policy_assignment",
      "name": "guest_configuration",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "Assignment of the Guest Configuration initiative to subscription.",
            "display_name": "Guest Configuration",
            "enforce": true,
            "id": "/subscriptions/19a7ed62-f51f-4e53-b3ea-6ba9a63f17fe/resourceGroups/rg-avs-migrate-manage-kcl-westus2-001/providers/Microsoft.Authorization/policyAssignments/guest_configuration",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "496c722e-374b-433b-9a31-763b383fe24d",
                "tenant_id": "d1c719f7-cc48-4f9f-83ec-f706a2a940fe",
                "type": "SystemAssigned"
              }
            ],
            "location": "westus2",
            "metadata": "{\"createdBy\":\"355c85c8-2bd0-4fde-9250-76aa4dd16b11\",\"createdOn\":\"2022-12-06T07:11:23.0268436Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "guest_configuration",
            "non_compliance_message": [],
            "not_scopes": null,
            "parameters": "",
            "policy_definition_id": "/subscriptions/19a7ed62-f51f-4e53-b3ea-6ba9a63f17fe/providers/Microsoft.Authorization/policySetDefinitions/guest_configuration",
            "resource_group_id": "/subscriptions/19a7ed62-f51f-4e53-b3ea-6ba9a63f17fe/resourceGroups/rg-avs-migrate-manage-kcl-westus2-001",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.policy_assignments.data.azurerm_resource_group.rggroup",
            "module.policyset_definitions.azurerm_policy_set_definition.guest_configuration",
            "module.policyset_definitions.data.azurerm_policy_definition.builtin_policies_guest_configuration"
          ]
        }
      ]
    },
    {
      "module": "module.policyset_definitions",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "builtin_policies_guest_configuration",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "description": "This policy adds a system-assigned managed identity to virtual machines hosted in Azure that are supported by Guest Configuration but do not have any managed identities. A system-assigned managed identity is a prerequisite for all Guest Configuration assignments and must be added to machines before using any Guest Configuration policy definitions. For more information on Guest Configuration, visit https://aka.ms/gcpol.",
            "display_name": "Add system-assigned managed identity to enable Guest Configuration assignments on virtual machines with no identities",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"version\":\"4.0.0\"}",
            "name": "3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-windows*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"greaterOrEquals\":\"2018-10-01\",\"value\":\"[requestContext().apiVersion]\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"identity.type\"},{\"equals\":\"None\",\"field\":\"identity.type\"}]}]},\"then\":{\"details\":{\"operations\":[{\"field\":\"identity.type\",\"operation\":\"addOrReplace\",\"value\":\"SystemAssigned\"}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"]},\"effect\":\"modify\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 1,
          "schema_version": 0,
          "attributes": {
            "description": "This policy adds a system-assigned managed identity to virtual machines hosted in Azure that are supported by Guest Configuration and have at least one user-assigned identity but do not have a system-assigned managed identity. A system-assigned managed identity is a prerequisite for all Guest Configuration assignments and must be added to machines before using any Guest Configuration policy definitions. For more information on Guest Configuration, visit https://aka.ms/gcpol.",
            "display_name": "Add system-assigned managed identity to enable Guest Configuration assignments on VMs with a user-assigned identity",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/497dff13-db2a-4c0f-8603-28fa3b331ab6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"version\":\"4.0.0\"}",
            "name": "497dff13-db2a-4c0f-8603-28fa3b331ab6",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-windows*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"greaterOrEquals\":\"2018-10-01\",\"value\":\"[requestContext().apiVersion]\"},{\"contains\":\"UserAssigned\",\"field\":\"identity.type\"},{\"field\":\"identity.type\",\"notContains\":\"SystemAssigned\"}]},\"then\":{\"details\":{\"operations\":[{\"field\":\"identity.type\",\"operation\":\"addOrReplace\",\"value\":\"[concat(field('identity.type'), ',SystemAssigned')]\"}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"]},\"effect\":\"modify\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 2,
          "schema_version": 0,
          "attributes": {
            "description": "This policy deploys the Windows Guest Configuration extension to Windows virtual machines hosted in Azure that are supported by Guest Configuration. The Windows Guest Configuration extension is a prerequisite for all Windows Guest Configuration assignments and must be deployed to machines before using any Windows Guest Configuration policy definition. For more information on Guest Configuration, visit https://aka.ms/gcpol.",
            "display_name": "Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"version\":\"1.2.0\"}",
            "name": "385f5831-96d4-41db-9a3c-cd3af78aaae6",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-07-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"protectedSettings\":{},\"publisher\":\"Microsoft.GuestConfiguration\",\"settings\":{},\"type\":\"ConfigurationforWindows\",\"typeHandlerVersion\":\"1.1\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}]}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.GuestConfiguration\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"ConfigurationforWindows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"name\":\"AzurePolicyforWindows\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 3,
          "schema_version": 0,
          "attributes": {
            "description": "This policy deploys the Linux Guest Configuration extension to Linux virtual machines hosted in Azure that are supported by Guest Configuration. The Linux Guest Configuration extension is a prerequisite for all Linux Guest Configuration assignments and must be deployed to machines before using any Linux Guest Configuration policy definition. For more information on Guest Configuration, visit https://aka.ms/gcpol.",
            "display_name": "Deploy the Linux Guest Configuration extension to enable Guest Configuration assignments on Linux VMs",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"version\":\"3.0.0\"}",
            "name": "331e8ea8-378a-410f-a2e5-ae22f38bb0da",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-windows*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-07-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"protectedSettings\":{},\"publisher\":\"Microsoft.GuestConfiguration\",\"settings\":{},\"type\":\"ConfigurationforLinux\",\"typeHandlerVersion\":\"1.0\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}]}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Microsoft.GuestConfiguration\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"ConfigurationforLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"name\":\"AzurePolicyforLinux\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 4,
          "schema_version": 0,
          "attributes": {
            "description": "This policy adds a user-assigned managed identity to virtual machines hosted in Azure that are supported by Guest Configuration. A user-assigned managed identity is a prerequisite for all Guest Configuration assignments and must be added to machines before using any Guest Configuration policy definitions. For more information on Guest Configuration, visit https://aka.ms/gcpol.",
            "display_name": "[Preview]: Add user-assigned managed identity to enable Guest Configuration assignments on virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f40c7c00-b4e3-4068-a315-5fe81347a904",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"preview\":true,\"version\":\"2.0.0-preview\"}",
            "name": "f40c7c00-b4e3-4068-a315-5fe81347a904",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match.\",\"displayName\":\"Policy Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-windows*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"greaterOrEquals\":\"2018-10-01\",\"value\":\"[requestContext().apiVersion]\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"eastus\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"bringYourOwnUserAssignedManagedIdentity\":{\"value\":false},\"identityResourceGroup\":{\"value\":\"Built-In-Identity-RG\"},\"location\":{\"value\":\"[field('location')]\"},\"resourceId\":{\"value\":\"[field('id')]\"},\"uaName\":{\"value\":\"Built-In-Identity\"},\"vmName\":{\"value\":\"[field('name')]\"},\"vmResourceGroup\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.1\",\"parameters\":{\"bringYourOwnUserAssignedManagedIdentity\":{\"type\":\"bool\"},\"identityResourceGroup\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"resourceId\":{\"type\":\"string\"},\"uaName\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"vmResourceGroup\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"condition\":\"[not(parameters('bringYourOwnUserAssignedManagedIdentity'))]\",\"location\":\"eastus\",\"name\":\"[parameters('identityResourceGroup')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2020-06-01\",\"condition\":\"[parameters('bringYourOwnUserAssignedManagedIdentity')]\",\"name\":\"[variables('deployUALockName')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"uaName\":{\"value\":\"[parameters('uaName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"uaName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2016-09-01\",\"name\":\"[concat('CanNotDeleteLock-', parameters('uaName'))]\",\"properties\":{\"level\":\"CanNotDelete\",\"notes\":\"Please do not delete this User-Assigned Identity since extensions enabled by Azure Policy are relying on their existence.\"},\"scope\":\"[concat('Microsoft.ManagedIdentity/userAssignedIdentities/', parameters('uaName'))]\",\"type\":\"Microsoft.Authorization/locks\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('identityResourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"condition\":\"[not(parameters('bringYourOwnUserAssignedManagedIdentity'))]\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\"],\"name\":\"[variables('deployUAName')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[parameters('location')]\"},\"uaName\":{\"value\":\"[variables('uaNameWithLocation')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"uaName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-11-30\",\"location\":\"[parameters('location')]\",\"name\":\"[parameters('uaName')]\",\"type\":\"Microsoft.ManagedIdentity/userAssignedIdentities\"},{\"apiVersion\":\"2016-09-01\",\"dependsOn\":[\"[parameters('uaName')]\"],\"name\":\"[concat(parameters('uaName'), '/Microsoft.Authorization/', 'CanNotDeleteLock-', parameters('uaName'))]\",\"properties\":{\"level\":\"CanNotDelete\",\"notes\":\"Please do not delete this User-Assigned Identity since extensions enabled by Azure Policy are relying on their existence.\"},\"type\":\"Microsoft.ManagedIdentity/userAssignedIdentities/providers/locks\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('identityResourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\",\"[variables('deployUAName')]\"],\"location\":\"eastus\",\"name\":\"[variables('deployGetResourceProperties')]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"resource\":{\"type\":\"object\",\"value\":\"[reference(parameters('resourceId'), '2019-07-01', 'Full')]\"}},\"resources\":[]}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', parameters('identityResourceGroup'))]\",\"[variables('deployUAName')]\",\"[variables('deployGetResourceProperties')]\"],\"name\":\"[concat(variables('deployAssignUAName'))]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"identityType\":{\"value\":\"[if(contains(reference(variables('deployGetResourceProperties')).outputs.resource.value, 'identity'), reference(variables('deployGetResourceProperties')).outputs.resource.value.identity.type, '')]\"},\"location\":{\"value\":\"[parameters('location')]\"},\"uaId\":{\"value\":\"[if(parameters('bringYourOwnUserAssignedManagedIdentity'), variables('precreatedUaId'), variables('autocreatedUaId'))]\"},\"userAssignedIdentities\":{\"value\":\"[if(and(contains(reference(variables('deployGetResourceProperties')).outputs.resource.value, 'identity'), contains(reference(variables('deployGetResourceProperties')).outputs.resource.value.identity, 'userAssignedIdentities')), reference(variables('deployGetResourceProperties')).outputs.resource.value.identity.userAssignedIdentities, createObject())]\"},\"vmName\":{\"value\":\"[parameters('vmName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"identityType\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"uaId\":{\"type\":\"string\"},\"userAssignedIdentities\":{\"type\":\"object\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-07-01\",\"identity\":{\"type\":\"[variables('identityTypeValue')]\",\"userAssignedIdentities\":\"[variables('userAssignedIdentitiesValue')]\"},\"location\":\"[parameters('location')]\",\"name\":\"[parameters('vmName')]\",\"type\":\"Microsoft.Compute/virtualMachines\"}],\"variables\":{\"identityTypeValue\":\"[if(contains(parameters('identityType'), 'SystemAssigned'), 'SystemAssigned,UserAssigned', 'UserAssigned')]\",\"userAssignedIdentitiesValue\":\"[union(parameters('userAssignedIdentities'), createObject(parameters('uaId'), createObject()))]\"}}},\"resourceGroup\":\"[parameters('vmResourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"autocreatedUaId\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('uaName')), '-', parameters('location'))]\",\"deployAssignUAName\":\"[concat('deployAssignUA-', uniqueString(deployment().name))]\",\"deployGetResourceProperties\":\"[concat('deployGetResourceProperties-', uniqueString(deployment().name))]\",\"deployUALockName\":\"[concat('deployUALock-', uniqueString(deployment().name))]\",\"deployUAName\":\"[concat('deployUA-', uniqueString(deployment().name))]\",\"precreatedUaId\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', trim(parameters('identityResourceGroup')), '/providers/Microsoft.ManagedIdentity/userAssignedIdentities/', trim(parameters('uaName')))]\",\"uaNameWithLocation\":\"[concat(parameters('uaName'),'-', parameters('location'))]\"}}}},\"deploymentScope\":\"subscription\",\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"contains\":\"UserAssigned\",\"field\":\"identity.type\"},{\"containsKey\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/Built-In-Identity-RG/providers/Microsoft.ManagedIdentity/userAssignedIdentities/Built-In-Identity-', field('location'))]\",\"field\":\"identity.userAssignedIdentities\"}]},\"name\":\"[field('name')]\",\"roleDefinitionIds\":[\"/subscriptions/fa5fc227-a624-475e-b696-cdd604c735bc/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\",\"/subscriptions/fa5fc227-a624-475e-b696-cdd604c735bc/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9\"],\"type\":\"Microsoft.Compute/virtualMachines\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/subscriptions/fa5fc227-a624-475e-b696-cdd604c735bc/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
              "/subscriptions/fa5fc227-a624-475e-b696-cdd604c735bc/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 5,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - Control Panel' for input personalization and prevention of enabling lock screens. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Administrative Templates - Control Panel'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3aa2661b-02d7-4ba6-99bc-dc36b10489fd",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureBaseline_AdministrativeTemplatesControlPanel\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "3aa2661b-02d7-4ba6-99bc-dc36b10489fd",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureBaseline_AdministrativeTemplatesControlPanel\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 6,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - Network' for guest logons, simultaneous connections, network bridge, ICS, and multicast name resolution. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Administrative Templates - Network'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/67e010c1-640d-438e-a3a5-feaccb533a98",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\":\"Minimize the number of simultaneous connections to the Internet or a Windows Domain;ExpectedValue\",\"EnableInsecureGuestLogons\":\"Enable insecure guest logons;ExpectedValue\",\"TurnOffMulticastNameResolution\":\"Turn off multicast name resolution;ExpectedValue\"},\"name\":\"AzureBaseline_AdministrativeTemplatesNetwork\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "67e010c1-640d-438e-a3a5-feaccb533a98",
            "parameters": "{\"AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specify whether to prevent computers from connecting to both a domain based network and a non-domain based network at the same time. A value of 0 allows simultaneous connections, and a value of 1 blocks them.\",\"displayName\":\"Allow simultaneous connections to the Internet or a Windows Domain\"}},\"EnableInsecureGuestLogons\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether the SMB client will allow insecure guest logons to an SMB server.\",\"displayName\":\"Enable insecure guest logons\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"TurnOffMulticastNameResolution\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether LLMNR, a secondary name resolution protocol that transmits using multicast over a local subnet link on a single subnet, is enabled.\",\"displayName\":\"Turn off multicast name resolution\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Enable insecure guest logons;ExpectedValue', '=', parameters('EnableInsecureGuestLogons'), ',', 'Minimize the number of simultaneous connections to the Internet or a Windows Domain;ExpectedValue', '=', parameters('AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain'), ',', 'Turn off multicast name resolution;ExpectedValue', '=', parameters('TurnOffMulticastNameResolution')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_AdministrativeTemplatesNetwork\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 7,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - System' for settings that control the administrative experience and Remote Assistance. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Administrative Templates - System'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/968410dc-5ca0-4518-8a5b-7b55f0530ea9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AlwaysUseClassicLogon\":\"Always use classic logon;ExpectedValue\",\"BootStartDriverInitializationPolicy\":\"Boot-Start Driver Initialization Policy;ExpectedValue\",\"EnableWindowsNTPClient\":\"Enable Windows NTP Client;ExpectedValue\",\"TurnOnConveniencePINSignin\":\"Turn on convenience PIN sign-in;ExpectedValue\"},\"name\":\"AzureBaseline_AdministrativeTemplatesSystem\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "968410dc-5ca0-4518-8a5b-7b55f0530ea9",
            "parameters": "{\"AlwaysUseClassicLogon\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether to force the user to log on to the computer using the classic logon screen. This setting only works when the computer is not on a domain.\",\"displayName\":\"Always use classic logon\"}},\"BootStartDriverInitializationPolicy\":{\"type\":\"String\",\"defaultValue\":\"3\",\"metadata\":{\"description\":\"Specifies which boot-start drivers are initialized based on a classification determined by an Early Launch Antimalware boot-start driver.\",\"displayName\":\"Boot-Start Driver Initialization Policy\"}},\"EnableWindowsNTPClient\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether the Windows NTP Client is enabled. Enabling the Windows NTP Client allows your computer to synchronize its computer clock with other NTP servers.\",\"displayName\":\"Enable Windows NTP Client\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"TurnOnConveniencePINSignin\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether a domain user can sign in using a convenience PIN.\",\"displayName\":\"Turn on convenience PIN sign-in\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Always use classic logon;ExpectedValue', '=', parameters('AlwaysUseClassicLogon'), ',', 'Boot-Start Driver Initialization Policy;ExpectedValue', '=', parameters('BootStartDriverInitializationPolicy'), ',', 'Enable Windows NTP Client;ExpectedValue', '=', parameters('EnableWindowsNTPClient'), ',', 'Turn on convenience PIN sign-in;ExpectedValue', '=', parameters('TurnOnConveniencePINSignin')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_AdministrativeTemplatesSystem\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 8,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - MSS (Legacy)' for automatic logon, screen saver, network behavior, safe DLL, and event log. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Administrative Templates - MSS (Legacy)'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e0a7e899-2ce2-4253-8a13-d808fdeb75af",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureBaseline_AdminstrativeTemplatesMSSLegacy\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "e0a7e899-2ce2-4253-8a13-d808fdeb75af",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureBaseline_AdminstrativeTemplatesMSSLegacy\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 9,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Accounts' for limiting local account use of blank passwords and guest account status. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Accounts'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ee984370-154a-4ee8-9726-19d900e56fc0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AccountsGuestAccountStatus\":\"Accounts: Guest account status;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsAccounts\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "ee984370-154a-4ee8-9726-19d900e56fc0",
            "parameters": "{\"AccountsGuestAccountStatus\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether the local Guest account is disabled.\",\"displayName\":\"Accounts: Guest account status\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Accounts: Guest account status;ExpectedValue', '=', parameters('AccountsGuestAccountStatus')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsAccounts\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 10,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Audit' for forcing audit policy subcategory and shutting down if unable to log security audits. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Audit'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/33936777-f2ac-45aa-82ec-07958ec9ade4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\":\"Audit: Shut down system immediately if unable to log security audits;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsAudit\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "33936777-f2ac-45aa-82ec-07958ec9ade4",
            "parameters": "{\"AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Audits if the system will shut down when unable to log Security events.\",\"displayName\":\"Audit: Shut down system immediately if unable to log security audits\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Audit: Shut down system immediately if unable to log security audits;ExpectedValue', '=', parameters('AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsAudit\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 11,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Devices' for undocking without logging on, installing print drivers, and formatting/ejecting media. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Devices'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8794ff4f-1a35-4e18-938f-0b22055067cd",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"DevicesAllowedToFormatAndEjectRemovableMedia\":\"Devices: Allowed to format and eject removable media;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsDevices\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "8794ff4f-1a35-4e18-938f-0b22055067cd",
            "parameters": "{\"DevicesAllowedToFormatAndEjectRemovableMedia\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies who is allowed to format and eject removable NTFS media. You can use this policy setting to prevent unauthorized users from removing data on one computer to access it on another computer on which they have local administrator privileges.\",\"displayName\":\"Devices: Allowed to format and eject removable media\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Devices: Allowed to format and eject removable media;ExpectedValue', '=', parameters('DevicesAllowedToFormatAndEjectRemovableMedia')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsDevices\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 12,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Interactive Logon' for displaying last user name and requiring ctrl-alt-del. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Interactive Logon'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d472d2c9-d6a3-4500-9f5f-b15f123005aa",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureBaseline_SecurityOptionsInteractiveLogon\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "d472d2c9-d6a3-4500-9f5f-b15f123005aa",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureBaseline_SecurityOptionsInteractiveLogon\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 13,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Microsoft Network Client' for Microsoft network client/server and SMB v1. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Microsoft Network Client'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d6c69680-54f0-4349-af10-94dd05f4225e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"MicrosoftNetworkClientDigitallySignCommunicationsAlways\":\"Microsoft network client: Digitally sign communications (always);ExpectedValue\",\"MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\":\"Microsoft network client: Send unencrypted password to third-party SMB servers;ExpectedValue\",\"MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\":\"Microsoft network server: Amount of idle time required before suspending session;ExpectedValue\",\"MicrosoftNetworkServerDigitallySignCommunicationsAlways\":\"Microsoft network server: Digitally sign communications (always);ExpectedValue\",\"MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\":\"Microsoft network server: Disconnect clients when logon hours expire;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsMicrosoftNetworkClient\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "d6c69680-54f0-4349-af10-94dd05f4225e",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"MicrosoftNetworkClientDigitallySignCommunicationsAlways\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether packet signing is required by the SMB client component.\",\"displayName\":\"Microsoft network client: Digitally sign communications (always)\"}},\"MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether the SMB redirector will send plaintext passwords during authentication to third-party SMB servers that do not support password encryption. It is recommended that you disable this policy setting unless there is a strong business case to enable it.\",\"displayName\":\"Microsoft network client: Send unencrypted password to third-party SMB servers\"}},\"MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\":{\"type\":\"String\",\"defaultValue\":\"1,15\",\"metadata\":{\"description\":\"Specifies the amount of continuous idle time that must pass in an SMB session before the session is suspended because of inactivity. The format of the value is two integers separated by a comma, denoting an inclusive range.\",\"displayName\":\"Microsoft network server: Amount of idle time required before suspending session\"}},\"MicrosoftNetworkServerDigitallySignCommunicationsAlways\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether packet signing is required by the SMB server component.\",\"displayName\":\"Microsoft network server: Digitally sign communications (always)\"}},\"MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether to disconnect users who are connected to the local computer outside their user account's valid logon hours. This setting affects the Server Message Block (SMB) component. If you enable this policy setting you should also enable 'Network security: Force logoff when logon hours expire'\",\"displayName\":\"Microsoft network server: Disconnect clients when logon hours expire\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Microsoft network client: Digitally sign communications (always);ExpectedValue', '=', parameters('MicrosoftNetworkClientDigitallySignCommunicationsAlways'), ',', 'Microsoft network client: Send unencrypted password to third-party SMB servers;ExpectedValue', '=', parameters('MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers'), ',', 'Microsoft network server: Amount of idle time required before suspending session;ExpectedValue', '=', parameters('MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession'), ',', 'Microsoft network server: Digitally sign communications (always);ExpectedValue', '=', parameters('MicrosoftNetworkServerDigitallySignCommunicationsAlways'), ',', 'Microsoft network server: Disconnect clients when logon hours expire;ExpectedValue', '=', parameters('MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsMicrosoftNetworkClient\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 14,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Microsoft Network Server' for disabling SMB v1 server. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Microsoft Network Server'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/caf2d518-f029-4f6b-833b-d7081702f253",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureBaseline_SecurityOptionsMicrosoftNetworkServer\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "caf2d518-f029-4f6b-833b-d7081702f253",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureBaseline_SecurityOptionsMicrosoftNetworkServer\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 15,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Network Access' for including access for anonymous users, local accounts, and remote access to the registry. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Network Access'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3ff60f98-7fa4-410a-9f7f-0b00f5afdbdd",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"NetworkAccessRemotelyAccessibleRegistryPaths\":\"Network access: Remotely accessible registry paths;ExpectedValue\",\"NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\":\"Network access: Remotely accessible registry paths and sub-paths;ExpectedValue\",\"NetworkAccessSharesThatCanBeAccessedAnonymously\":\"Network access: Shares that can be accessed anonymously;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsNetworkAccess\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "3ff60f98-7fa4-410a-9f7f-0b00f5afdbdd",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"NetworkAccessRemotelyAccessibleRegistryPaths\":{\"type\":\"String\",\"defaultValue\":\"System\\\\CurrentControlSet\\\\Control\\\\ProductOptions|#|System\\\\CurrentControlSet\\\\Control\\\\Server Applications|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\",\"metadata\":{\"description\":\"Specifies which registry paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the `winreg` registry key.\",\"displayName\":\"Network access: Remotely accessible registry paths\"}},\"NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\":{\"type\":\"String\",\"defaultValue\":\"System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|#|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|#|Software\\\\Microsoft\\\\OLAP Server|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|#|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|#|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog\",\"metadata\":{\"description\":\"Specifies which registry paths and sub-paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the `winreg` registry key.\",\"displayName\":\"Network access: Remotely accessible registry paths and sub-paths\"}},\"NetworkAccessSharesThatCanBeAccessedAnonymously\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies which network shares can be accessed by anonymous users. The default configuration for this policy setting has little effect because all users have to be authenticated before they can access shared resources on the server.\",\"displayName\":\"Network access: Shares that can be accessed anonymously\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Network access: Remotely accessible registry paths;ExpectedValue', '=', parameters('NetworkAccessRemotelyAccessibleRegistryPaths'), ',', 'Network access: Remotely accessible registry paths and sub-paths;ExpectedValue', '=', parameters('NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths'), ',', 'Network access: Shares that can be accessed anonymously;ExpectedValue', '=', parameters('NetworkAccessSharesThatCanBeAccessedAnonymously')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsNetworkAccess\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 16,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Network Security' for including Local System behavior, PKU2U, LAN Manager, LDAP client, and NTLM SSP. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Network Security'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1221c620-d201-468c-81e7-2817e6107e84",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\":\"Network Security: Configure encryption types allowed for Kerberos;ExpectedValue\",\"NetworkSecurityLANManagerAuthenticationLevel\":\"Network security: LAN Manager authentication level;ExpectedValue\",\"NetworkSecurityLDAPClientSigningRequirements\":\"Network security: LDAP client signing requirements;ExpectedValue\",\"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\":\"Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue\",\"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\":\"Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsNetworkSecurity\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "1221c620-d201-468c-81e7-2817e6107e84",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\":{\"type\":\"String\",\"defaultValue\":\"2147483644\",\"metadata\":{\"description\":\"Specifies the encryption types that Kerberos is allowed to use.\",\"displayName\":\"Network Security: Configure encryption types allowed for Kerberos\"}},\"NetworkSecurityLANManagerAuthenticationLevel\":{\"type\":\"String\",\"defaultValue\":\"5\",\"metadata\":{\"description\":\"Specify which challenge-response authentication protocol is used for network logons. This choice affects the level of authentication protocol used by clients, the level of session security negotiated, and the level of authentication accepted by servers.\",\"displayName\":\"Network security: LAN Manager authentication level\"}},\"NetworkSecurityLDAPClientSigningRequirements\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specify the level of data signing that is requested on behalf of clients that issue LDAP BIND requests.\",\"displayName\":\"Network security: LDAP client signing requirements\"}},\"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\":{\"type\":\"String\",\"defaultValue\":\"537395200\",\"metadata\":{\"description\":\"Specifies which behaviors are allowed by clients for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services. See https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-minimum-session-security-for-ntlm-ssp-based-including-secure-rpc-servers for more information.\",\"displayName\":\"Network security: Minimum session security for NTLM SSP based (including secure RPC) clients\"}},\"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\":{\"type\":\"String\",\"defaultValue\":\"537395200\",\"metadata\":{\"description\":\"Specifies which behaviors are allowed by servers for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services.\",\"displayName\":\"Network security: Minimum session security for NTLM SSP based (including secure RPC) servers\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Network Security: Configure encryption types allowed for Kerberos;ExpectedValue', '=', parameters('NetworkSecurityConfigureEncryptionTypesAllowedForKerberos'), ',', 'Network security: LAN Manager authentication level;ExpectedValue', '=', parameters('NetworkSecurityLANManagerAuthenticationLevel'), ',', 'Network security: LDAP client signing requirements;ExpectedValue', '=', parameters('NetworkSecurityLDAPClientSigningRequirements'), ',', 'Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue', '=', parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients'), ',', 'Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue', '=', parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsNetworkSecurity\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 17,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Recovery console' for allowing floppy copy and access to all drives and folders. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Recovery console'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f71be03e-e25b-4d0f-b8bc-9b3e309b66c0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\":\"Recovery console: Allow floppy copy and access to all drives and all folders;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsRecoveryconsole\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "f71be03e-e25b-4d0f-b8bc-9b3e309b66c0",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether to make the Recovery Console SET command available, which allows setting of recovery console environment variables.\",\"displayName\":\"Recovery console: Allow floppy copy and access to all drives and all folders\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Recovery console: Allow floppy copy and access to all drives and all folders;ExpectedValue', '=', parameters('RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsRecoveryconsole\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 18,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - Shutdown' for allowing shutdown without logon and clearing the virtual memory pagefile. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - Shutdown'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b4a4d1eb-0263-441b-84cb-a44073d8372d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\":\"Shutdown: Allow system to be shut down without having to log on;ExpectedValue\",\"ShutdownClearVirtualMemoryPagefile\":\"Shutdown: Clear virtual memory pagefile;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsShutdown\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "b4a4d1eb-0263-441b-84cb-a44073d8372d",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether a computer can be shut down when a user is not logged on. If this policy setting is enabled, the shutdown command is available on the Windows logon screen.\",\"displayName\":\"Shutdown: Allow system to be shut down without having to log on\"}},\"ShutdownClearVirtualMemoryPagefile\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether the virtual memory pagefile is cleared when the system is shut down. When this policy setting is enabled, the system pagefile is cleared each time that the system shuts down properly. For systems with large amounts of RAM, this could result in substantial time needed to complete the shutdown.\",\"displayName\":\"Shutdown: Clear virtual memory pagefile\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Shutdown: Allow system to be shut down without having to log on;ExpectedValue', '=', parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn'), ',', 'Shutdown: Clear virtual memory pagefile;ExpectedValue', '=', parameters('ShutdownClearVirtualMemoryPagefile')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsShutdown\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 19,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - System objects' for case insensitivity for non-Windows subsystems and permissions of internal system objects. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - System objects'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2f262ace-812a-4fd0-b731-b38ba9e9708d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureBaseline_SecurityOptionsSystemobjects\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "2f262ace-812a-4fd0-b731-b38ba9e9708d",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureBaseline_SecurityOptionsSystemobjects\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 20,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - System settings' for certificate rules on executables for SRP and optional subsystems. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - System settings'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/12017595-5a75-4bb1-9d97-4c2c939ea3c3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\":\"System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsSystemsettings\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "12017595-5a75-4bb1-9d97-4c2c939ea3c3",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether digital certificates are processed when software restriction policies are enabled and a user or process attempts to run software with an .exe file name extension. It enables or disables certificate rules (a type of software restriction policies rule). For certificate rules to take effect in software restriction policies, you must enable this policy setting.\",\"displayName\":\"System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue', '=', parameters('SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsSystemsettings\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 21,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Options - User Account Control' for mode for admins, behavior of elevation prompt, and virtualizing file and registry write failures. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Options - User Account Control'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/492a29ed-d143-4f03-b6a4-705ce081b463",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"UACAdminApprovalModeForTheBuiltinAdministratorAccount\":\"User Account Control: Admin Approval Mode for the Built-in Administrator account;ExpectedValue\",\"UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\":\"User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode;ExpectedValue\",\"UACDetectApplicationInstallationsAndPromptForElevation\":\"User Account Control: Detect application installations and prompt for elevation;ExpectedValue\",\"UACRunAllAdministratorsInAdminApprovalMode\":\"User Account Control: Run all administrators in Admin Approval Mode;ExpectedValue\"},\"name\":\"AzureBaseline_SecurityOptionsUserAccountControl\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "492a29ed-d143-4f03-b6a4-705ce081b463",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"UACAdminApprovalModeForTheBuiltinAdministratorAccount\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies the behavior of Admin Approval Mode for the built-in Administrator account.\",\"displayName\":\"UAC: Admin Approval Mode for the Built-in Administrator account\"}},\"UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\":{\"type\":\"String\",\"defaultValue\":\"2\",\"metadata\":{\"description\":\"Specifies the behavior of the elevation prompt for administrators.\",\"displayName\":\"UAC: Behavior of the elevation prompt for administrators in Admin Approval Mode\"}},\"UACDetectApplicationInstallationsAndPromptForElevation\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies the behavior of application installation detection for the computer.\",\"displayName\":\"UAC: Detect application installations and prompt for elevation\"}},\"UACRunAllAdministratorsInAdminApprovalMode\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies the behavior of all User Account Control (UAC) policy settings for the computer.\",\"displayName\":\"UAC: Run all administrators in Admin Approval Mode\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('User Account Control: Admin Approval Mode for the Built-in Administrator account;ExpectedValue', '=', parameters('UACAdminApprovalModeForTheBuiltinAdministratorAccount'), ',', 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode;ExpectedValue', '=', parameters('UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode'), ',', 'User Account Control: Detect application installations and prompt for elevation;ExpectedValue', '=', parameters('UACDetectApplicationInstallationsAndPromptForElevation'), ',', 'User Account Control: Run all administrators in Admin Approval Mode;ExpectedValue', '=', parameters('UACRunAllAdministratorsInAdminApprovalMode')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecurityOptionsUserAccountControl\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 22,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Security Settings - Account Policies' for password history, age, length, complexity, and storing passwords using reversible encryption. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Security Settings - Account Policies'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f2143251-70de-4e81-87a8-36cee5a2f29d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"EnforcePasswordHistory\":\"Enforce password history;ExpectedValue\",\"MaximumPasswordAge\":\"Maximum password age;ExpectedValue\",\"MinimumPasswordAge\":\"Minimum password age;ExpectedValue\",\"MinimumPasswordLength\":\"Minimum password length;ExpectedValue\",\"PasswordMustMeetComplexityRequirements\":\"Password must meet complexity requirements;ExpectedValue\"},\"name\":\"AzureBaseline_SecuritySettingsAccountPolicies\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "f2143251-70de-4e81-87a8-36cee5a2f29d",
            "parameters": "{\"EnforcePasswordHistory\":{\"type\":\"String\",\"defaultValue\":\"24\",\"metadata\":{\"description\":\"Specifies limits on password reuse - how many times a new password must be created for a user account before the password can be repeated.\",\"displayName\":\"Enforce password history\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"MaximumPasswordAge\":{\"type\":\"String\",\"defaultValue\":\"1,70\",\"metadata\":{\"description\":\"Specifies the maximum number of days that may elapse before a user account password must be changed. The format of the value is two integers separated by a comma, denoting an inclusive range.\",\"displayName\":\"Maximum password age\"}},\"MinimumPasswordAge\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies the minimum number of days that must elapse before a user account password can be changed.\",\"displayName\":\"Minimum password age\"}},\"MinimumPasswordLength\":{\"type\":\"String\",\"defaultValue\":\"14\",\"metadata\":{\"description\":\"Specifies the minimum number of characters that a user account password may contain.\",\"displayName\":\"Minimum password length\"}},\"PasswordMustMeetComplexityRequirements\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether a user account password must be complex. If required, a complex password must not contain part of  user's account name or full name; be at least 6 characters long; contain a mix of uppercase, lowercase, number, and non-alphabetic characters.\",\"displayName\":\"Password must meet complexity requirements\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Enforce password history;ExpectedValue', '=', parameters('EnforcePasswordHistory'), ',', 'Maximum password age;ExpectedValue', '=', parameters('MaximumPasswordAge'), ',', 'Minimum password age;ExpectedValue', '=', parameters('MinimumPasswordAge'), ',', 'Minimum password length;ExpectedValue', '=', parameters('MinimumPasswordLength'), ',', 'Password must meet complexity requirements;ExpectedValue', '=', parameters('PasswordMustMeetComplexityRequirements')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SecuritySettingsAccountPolicies\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 23,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Account Logon' for auditing credential validation and other account logon events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'System Audit Policies - Account Logon'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/43bb60fe-1d7e-4b82-9e93-496bfc99e7d5",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AuditCredentialValidation\":\"Audit Credential Validation;ExpectedValue\"},\"name\":\"AzureBaseline_SystemAuditPoliciesAccountLogon\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "43bb60fe-1d7e-4b82-9e93-496bfc99e7d5",
            "parameters": "{\"AuditCredentialValidation\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"Success and Failure\",\"metadata\":{\"description\":\"Specifies whether audit events are generated when credentials are submitted for a user account logon request.  This setting is especially useful for monitoring unsuccessful attempts, to find brute-force attacks, account enumeration, and potential account compromise events on domain controllers.\",\"displayName\":\"Audit Credential Validation\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Audit Credential Validation;ExpectedValue', '=', parameters('AuditCredentialValidation')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SystemAuditPoliciesAccountLogon\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 24,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Account Management' for auditing application, security, and user group management, and other management events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'System Audit Policies - Account Management'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/94d9aca8-3757-46df-aa51-f218c5f11954",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureBaseline_SystemAuditPoliciesAccountManagement\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "94d9aca8-3757-46df-aa51-f218c5f11954",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureBaseline_SystemAuditPoliciesAccountManagement\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 25,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Detailed Tracking' for auditing DPAPI, process creation/termination, RPC events, and PNP activity. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'System Audit Policies - Detailed Tracking'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/58383b73-94a9-4414-b382-4146eb02611b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AuditProcessTermination\":\"Audit Process Termination;ExpectedValue\"},\"name\":\"AzureBaseline_SystemAuditPoliciesDetailedTracking\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "58383b73-94a9-4414-b382-4146eb02611b",
            "parameters": "{\"AuditProcessTermination\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"No Auditing\",\"metadata\":{\"description\":\"Specifies whether audit events are generated when a process has exited. Recommended for monitoring termination of critical processes.\",\"displayName\":\"Audit Process Termination\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Audit Process Termination;ExpectedValue', '=', parameters('AuditProcessTermination')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SystemAuditPoliciesDetailedTracking\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 26,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Logon-Logoff' for auditing IPSec, network policy, claims, account lockout, group membership, and logon/logoff events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'System Audit Policies - Logon-Logoff'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/19be9779-c776-4dfa-8a15-a2fd5dc843d6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AuditGroupMembership\":\"Audit Group Membership;ExpectedValue\"},\"name\":\"AzureBaseline_SystemAuditPoliciesLogonLogoff\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "19be9779-c776-4dfa-8a15-a2fd5dc843d6",
            "parameters": "{\"AuditGroupMembership\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"Success\",\"metadata\":{\"description\":\"Specifies whether audit events are generated when group memberships are enumerated on the client computer.\",\"displayName\":\"Audit Group Membership\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Audit Group Membership;ExpectedValue', '=', parameters('AuditGroupMembership')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SystemAuditPoliciesLogonLogoff\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 27,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Object Access' for auditing file, registry, SAM, storage, filtering, kernel, and other system types. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'System Audit Policies - Object Access'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/35781875-8026-4628-b19b-f6efb4d88a1d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AuditDetailedFileShare\":\"Audit Detailed File Share;ExpectedValue\",\"AuditFileShare\":\"Audit File Share;ExpectedValue\",\"AuditFileSystem\":\"Audit File System;ExpectedValue\"},\"name\":\"AzureBaseline_SystemAuditPoliciesObjectAccess\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "35781875-8026-4628-b19b-f6efb4d88a1d",
            "parameters": "{\"AuditDetailedFileShare\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"No Auditing\",\"metadata\":{\"description\":\"If this policy setting is enabled, access to all shared files and folders on the system is audited. Auditing for Success can lead to very high volumes of events.\",\"displayName\":\"Audit Detailed File Share\"}},\"AuditFileShare\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"No Auditing\",\"metadata\":{\"description\":\"Specifies whether to audit events related to file shares: creation, deletion, modification, and access attempts. Also, it shows failed SMB SPN checks. Event volumes can be high on DCs and File Servers.\",\"displayName\":\"Audit File Share\"}},\"AuditFileSystem\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"No Auditing\",\"metadata\":{\"description\":\"Specifies whether audit events are generated when users attempt to access file system objects. Audit events are generated only for objects that have configured system access control lists (SACLs).\",\"displayName\":\"Audit File System\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Audit Detailed File Share;ExpectedValue', '=', parameters('AuditDetailedFileShare'), ',', 'Audit File Share;ExpectedValue', '=', parameters('AuditFileShare'), ',', 'Audit File System;ExpectedValue', '=', parameters('AuditFileSystem')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SystemAuditPoliciesObjectAccess\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 28,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Policy Change' for auditing changes to system audit policies. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'System Audit Policies - Policy Change'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2a7a701e-dff3-4da9-9ec5-42cb98594c0b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AuditAuthenticationPolicyChange\":\"Audit Authentication Policy Change;ExpectedValue\",\"AuditAuthorizationPolicyChange\":\"Audit Authorization Policy Change;ExpectedValue\"},\"name\":\"AzureBaseline_SystemAuditPoliciesPolicyChange\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "2a7a701e-dff3-4da9-9ec5-42cb98594c0b",
            "parameters": "{\"AuditAuthenticationPolicyChange\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"Success\",\"metadata\":{\"description\":\"Specifies whether audit events are generated when changes are made to authentication policy. This setting is useful for tracking changes in domain-level and forest-level trust and privileges that are granted to user accounts or groups.\",\"displayName\":\"Audit Authentication Policy Change\"}},\"AuditAuthorizationPolicyChange\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"No Auditing\",\"metadata\":{\"description\":\"Specifies whether audit events are generated for assignment and removal of user rights in user right policies, changes in security token object permission, resource attributes changes and Central Access Policy changes for file system objects.\",\"displayName\":\"Audit Authorization Policy Change\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Audit Authentication Policy Change;ExpectedValue', '=', parameters('AuditAuthenticationPolicyChange'), ',', 'Audit Authorization Policy Change;ExpectedValue', '=', parameters('AuditAuthorizationPolicyChange')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SystemAuditPoliciesPolicyChange\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 29,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Privilege Use' for auditing nonsensitive and other privilege use. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'System Audit Policies - Privilege Use'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/87845465-c458-45f3-af66-dcd62176f397",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"AzureBaseline_SystemAuditPoliciesPrivilegeUse\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "87845465-c458-45f3-af66-dcd62176f397",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"AzureBaseline_SystemAuditPoliciesPrivilegeUse\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 30,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - System' for auditing IPsec driver, system integrity, system extension, state change, and other system events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'System Audit Policies - System'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8316fa92-d69c-4810-8124-62414f560dcf",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AuditOtherSystemEvents\":\"Audit Other System Events;ExpectedValue\"},\"name\":\"AzureBaseline_SystemAuditPoliciesSystem\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "8316fa92-d69c-4810-8124-62414f560dcf",
            "parameters": "{\"AuditOtherSystemEvents\":{\"type\":\"String\",\"allowedValues\":[\"No Auditing\",\"Success\",\"Failure\",\"Success and Failure\"],\"defaultValue\":\"No Auditing\",\"metadata\":{\"description\":\"Specifies whether audit events are generated for Windows Firewall Service and Windows Firewall driver start and stop events, failure events for these services and Windows Firewall Service policy processing failures.\",\"displayName\":\"Audit Other System Events\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Audit Other System Events;ExpectedValue', '=', parameters('AuditOtherSystemEvents')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_SystemAuditPoliciesSystem\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 31,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'User Rights Assignment' for allowing log on locally, RDP, access from the network, and many other user activities. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'User Rights Assignment'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e068b215-0026-4354-b347-8fb2766f73a2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"UserAndGroupsThatMayForceShutdownFromARemoteSystem\":\"Force shutdown from a remote system;ExpectedValue\",\"UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\":\"Deny access to this computer from the network;ExpectedValue\",\"UsersAndGroupsThatAreDeniedLocalLogon\":\"Deny log on locally;ExpectedValue\",\"UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\":\"Deny log on through Remote Desktop Services;ExpectedValue\",\"UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\":\"Deny log on as a batch job;ExpectedValue\",\"UsersAndGroupsThatAreDeniedLoggingOnAsAService\":\"Deny log on as a service;ExpectedValue\",\"UsersAndGroupsThatMayRestoreFilesAndDirectories\":\"Restore files and directories;ExpectedValue\",\"UsersAndGroupsThatMayShutDownTheSystem\":\"Shut down the system;ExpectedValue\",\"UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\":\"Access this computer from the network;ExpectedValue\",\"UsersOrGroupsThatMayBackUpFilesAndDirectories\":\"Back up files and directories;ExpectedValue\",\"UsersOrGroupsThatMayChangeTheSystemTime\":\"Change the system time;ExpectedValue\",\"UsersOrGroupsThatMayChangeTheTimeZone\":\"Change the time zone;ExpectedValue\",\"UsersOrGroupsThatMayCreateATokenObject\":\"Create a token object;ExpectedValue\",\"UsersOrGroupsThatMayLogOnLocally\":\"Allow log on locally;ExpectedValue\",\"UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\":\"Allow log on through Remote Desktop Services;ExpectedValue\",\"UsersOrGroupsThatMayManageAuditingAndSecurityLog\":\"Manage auditing and security log;ExpectedValue\",\"UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\":\"Take ownership of files or other objects;ExpectedValue\"},\"name\":\"AzureBaseline_UserRightsAssignment\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "e068b215-0026-4354-b347-8fb2766f73a2",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"UserAndGroupsThatMayForceShutdownFromARemoteSystem\":{\"type\":\"String\",\"defaultValue\":\"Administrators\",\"metadata\":{\"description\":\"Specifies which users and groups are permitted to shut down the computer from a remote location on the network.\",\"displayName\":\"User and groups that may force shutdown from a remote system\"}},\"UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\":{\"type\":\"String\",\"defaultValue\":\"Guests\",\"metadata\":{\"description\":\"Specifies which users or groups are explicitly prohibited from connecting to the computer across the network.\",\"displayName\":\"Users and groups that are denied access to this computer from the network\"}},\"UsersAndGroupsThatAreDeniedLocalLogon\":{\"type\":\"String\",\"defaultValue\":\"Guests\",\"metadata\":{\"description\":\"Specifies which users and groups are explicitly not permitted to log on to the computer.\",\"displayName\":\"Users and groups that are denied local logon\"}},\"UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\":{\"type\":\"String\",\"defaultValue\":\"Guests\",\"metadata\":{\"description\":\"Specifies which users and groups are explicitly not permitted to log on to the computer via Terminal Services/Remote Desktop Client.\",\"displayName\":\"Users and groups that are denied log on through Remote Desktop Services\"}},\"UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\":{\"type\":\"String\",\"defaultValue\":\"Guests\",\"metadata\":{\"description\":\"Specifies which users and groups are explicitly not permitted to log on to the computer as a batch job (i.e. scheduled task).\",\"displayName\":\"Users and groups that are denied logging on as a batch job\"}},\"UsersAndGroupsThatAreDeniedLoggingOnAsAService\":{\"type\":\"String\",\"defaultValue\":\"Guests\",\"metadata\":{\"description\":\"Specifies which service accounts are explicitly not permitted to register a process as a service.\",\"displayName\":\"Users and groups that are denied logging on as a service\"}},\"UsersAndGroupsThatMayRestoreFilesAndDirectories\":{\"type\":\"String\",\"defaultValue\":\"Administrators, Backup Operators\",\"metadata\":{\"description\":\"Specifies which users and groups are permitted to bypass file, directory, registry, and other persistent object permissions when restoring backed up files and directories.\",\"displayName\":\"Users and groups that may restore files and directories\"}},\"UsersAndGroupsThatMayShutDownTheSystem\":{\"type\":\"String\",\"defaultValue\":\"Administrators\",\"metadata\":{\"description\":\"Specifies which users and groups who are logged on locally to the computers in your environment are permitted to shut down the operating system with the Shut Down command.\",\"displayName\":\"Users and groups that may shut down the system\"}},\"UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\":{\"type\":\"String\",\"defaultValue\":\"Administrators, Authenticated Users\",\"metadata\":{\"description\":\"Specifies which remote users on the network are permitted to connect to the computer. This does not include Remote Desktop Connection.\",\"displayName\":\"Users or groups that may access this computer from the network\"}},\"UsersOrGroupsThatMayBackUpFilesAndDirectories\":{\"type\":\"String\",\"defaultValue\":\"Administrators, Backup Operators\",\"metadata\":{\"description\":\"Specifies users and groups allowed to circumvent file and directory permissions to back up the system.\",\"displayName\":\"Users or groups that may back up files and directories\"}},\"UsersOrGroupsThatMayChangeTheSystemTime\":{\"type\":\"String\",\"defaultValue\":\"Administrators, LOCAL SERVICE\",\"metadata\":{\"description\":\"Specifies which users and groups are permitted to change the time and date on the internal clock of the computer.\",\"displayName\":\"Users or groups that may change the system time\"}},\"UsersOrGroupsThatMayChangeTheTimeZone\":{\"type\":\"String\",\"defaultValue\":\"Administrators, LOCAL SERVICE\",\"metadata\":{\"description\":\"Specifies which users and groups are permitted to change the time zone of the computer.\",\"displayName\":\"Users or groups that may change the time zone\"}},\"UsersOrGroupsThatMayCreateATokenObject\":{\"type\":\"String\",\"defaultValue\":\"No One\",\"metadata\":{\"description\":\"Specifies which users and groups are permitted to create an access token, which may provide elevated rights to access sensitive data.\",\"displayName\":\"Users or groups that may create a token object\"}},\"UsersOrGroupsThatMayLogOnLocally\":{\"type\":\"String\",\"defaultValue\":\"Administrators\",\"metadata\":{\"description\":\"Specifies which users or groups can interactively log on to the computer. Users who attempt to log on via Remote Desktop Connection or IIS also require this user right.\",\"displayName\":\"Users or groups that may log on locally\"}},\"UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\":{\"type\":\"String\",\"defaultValue\":\"Administrators, Remote Desktop Users\",\"metadata\":{\"description\":\"Specifies which users or groups are permitted to log on as a Terminal Services client, Remote Desktop, or for Remote Assistance.\",\"displayName\":\"Users or groups that may log on through Remote Desktop Services\"}},\"UsersOrGroupsThatMayManageAuditingAndSecurityLog\":{\"type\":\"String\",\"defaultValue\":\"Administrators\",\"metadata\":{\"description\":\"Specifies users and groups permitted to change the auditing options for files and directories and clear the Security log.\",\"displayName\":\"Users or groups that may manage auditing and security log\"}},\"UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\":{\"type\":\"String\",\"defaultValue\":\"Administrators\",\"metadata\":{\"description\":\"Specifies which users and groups are permitted to take ownership of files, folders, registry keys, processes, or threads. This user right bypasses any permissions that are in place to protect objects to give ownership to the specified user.\",\"displayName\":\"Users or groups that may take ownership of files or other objects\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Access this computer from the network;ExpectedValue', '=', parameters('UsersOrGroupsThatMayAccessThisComputerFromTheNetwork'), ',', 'Allow log on locally;ExpectedValue', '=', parameters('UsersOrGroupsThatMayLogOnLocally'), ',', 'Allow log on through Remote Desktop Services;ExpectedValue', '=', parameters('UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices'), ',', 'Deny access to this computer from the network;ExpectedValue', '=', parameters('UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork'), ',', 'Manage auditing and security log;ExpectedValue', '=', parameters('UsersOrGroupsThatMayManageAuditingAndSecurityLog'), ',', 'Back up files and directories;ExpectedValue', '=', parameters('UsersOrGroupsThatMayBackUpFilesAndDirectories'), ',', 'Change the system time;ExpectedValue', '=', parameters('UsersOrGroupsThatMayChangeTheSystemTime'), ',', 'Change the time zone;ExpectedValue', '=', parameters('UsersOrGroupsThatMayChangeTheTimeZone'), ',', 'Create a token object;ExpectedValue', '=', parameters('UsersOrGroupsThatMayCreateATokenObject'), ',', 'Deny log on as a batch job;ExpectedValue', '=', parameters('UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob'), ',', 'Deny log on as a service;ExpectedValue', '=', parameters('UsersAndGroupsThatAreDeniedLoggingOnAsAService'), ',', 'Deny log on locally;ExpectedValue', '=', parameters('UsersAndGroupsThatAreDeniedLocalLogon'), ',', 'Deny log on through Remote Desktop Services;ExpectedValue', '=', parameters('UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices'), ',', 'Force shutdown from a remote system;ExpectedValue', '=', parameters('UserAndGroupsThatMayForceShutdownFromARemoteSystem'), ',', 'Restore files and directories;ExpectedValue', '=', parameters('UsersAndGroupsThatMayRestoreFilesAndDirectories'), ',', 'Shut down the system;ExpectedValue', '=', parameters('UsersAndGroupsThatMayShutDownTheSystem'), ',', 'Take ownership of files or other objects;ExpectedValue', '=', parameters('UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_UserRightsAssignment\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 32,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Windows Components' for basic authentication, unencrypted traffic, Microsoft accounts, telemetry, Cortana, and other Windows behaviors. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Windows Components'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8537fe96-8cbe-43de-b0ef-131bc72bc22a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"AllowIndexingOfEncryptedFiles\":\"Allow indexing of encrypted files;ExpectedValue\",\"AllowTelemetry\":\"Allow Telemetry;ExpectedValue\",\"AllowUnencryptedTraffic\":\"Allow unencrypted traffic;ExpectedValue\",\"AlwaysInstallWithElevatedPrivileges\":\"Always install with elevated privileges;ExpectedValue\",\"AlwaysPromptForPasswordUponConnection\":\"Always prompt for password upon connection;ExpectedValue\",\"ApplicationSpecifyTheMaximumLogFileSizeKB\":\"Application: Specify the maximum log file size (KB);ExpectedValue\",\"AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\":\"Automatically send memory dumps for OS-generated error reports;ExpectedValue\",\"ConfigureDefaultConsent\":\"Configure Default consent;ExpectedValue\",\"ConfigureWindowsSmartScreen\":\"Configure Windows SmartScreen;ExpectedValue\",\"DisallowDigestAuthentication\":\"Disallow Digest authentication;ExpectedValue\",\"DisallowWinRMFromStoringRunAsCredentials\":\"Disallow WinRM from storing RunAs credentials;ExpectedValue\",\"DoNotAllowPasswordsToBeSaved\":\"Do not allow passwords to be saved;ExpectedValue\",\"SecuritySpecifyTheMaximumLogFileSizeKB\":\"Security: Specify the maximum log file size (KB);ExpectedValue\",\"SendFileSamplesWhenFurtherAnalysisIsRequired\":\"Send file samples when further analysis is required;ExpectedValue\",\"SetClientConnectionEncryptionLevel\":\"Set client connection encryption level;ExpectedValue\",\"SetTheDefaultBehaviorForAutoRun\":\"Set the default behavior for AutoRun;ExpectedValue\",\"SetupSpecifyTheMaximumLogFileSizeKB\":\"Setup: Specify the maximum log file size (KB);ExpectedValue\",\"SpecifyTheIntervalToCheckForDefinitionUpdates\":\"Specify the interval to check for definition updates;ExpectedValue\",\"SystemSpecifyTheMaximumLogFileSizeKB\":\"System: Specify the maximum log file size (KB);ExpectedValue\",\"TurnOffDataExecutionPreventionForExplorer\":\"Turn off Data Execution Prevention for Explorer;ExpectedValue\"},\"name\":\"AzureBaseline_WindowsComponents\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "8537fe96-8cbe-43de-b0ef-131bc72bc22a",
            "parameters": "{\"AllowIndexingOfEncryptedFiles\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether encrypted items are allowed to be indexed.\",\"displayName\":\"Allow indexing of encrypted files\"}},\"AllowTelemetry\":{\"type\":\"String\",\"defaultValue\":\"2\",\"metadata\":{\"description\":\"Specifies configuration of the amount of diagnostic and usage data reported to Microsoft. The data is transmitted securely and sensitive data is not sent.\",\"displayName\":\"Allow Telemetry\"}},\"AllowUnencryptedTraffic\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether the Windows Remote Management (WinRM) service sends and receives unencrypted messages over the network.\",\"displayName\":\"Allow unencrypted traffic\"}},\"AlwaysInstallWithElevatedPrivileges\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether Windows Installer should use system permissions when it installs any program on the system.\",\"displayName\":\"Always install with elevated privileges\"}},\"AlwaysPromptForPasswordUponConnection\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether Terminal Services/Remote Desktop Connection always prompts the client computer for a password upon connection.\",\"displayName\":\"Always prompt for password upon connection\"}},\"ApplicationSpecifyTheMaximumLogFileSizeKB\":{\"type\":\"String\",\"defaultValue\":\"32768\",\"metadata\":{\"description\":\"Specifies the maximum size for the Application event log in kilobytes.\",\"displayName\":\"Application: Specify the maximum log file size (KB)\"}},\"AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies if memory dumps in support of OS-generated error reports can be sent to Microsoft automatically.\",\"displayName\":\"Automatically send memory dumps for OS-generated error reports\"}},\"ConfigureDefaultConsent\":{\"type\":\"String\",\"defaultValue\":\"4\",\"metadata\":{\"description\":\"Specifies setting of the default consent handling for error reports sent to Microsoft.\",\"displayName\":\"Configure Default consent\"}},\"ConfigureWindowsSmartScreen\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies how to manage the behavior of Windows SmartScreen. Windows SmartScreen helps keep PCs safer by warning users before running unrecognized programs downloaded from the Internet. Some information is sent to Microsoft about files and programs run on PCs with this feature enabled.\",\"displayName\":\"Configure Windows SmartScreen\"}},\"DisallowDigestAuthentication\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether the Windows Remote Management (WinRM) client will not use Digest authentication.\",\"displayName\":\"Disallow Digest authentication\"}},\"DisallowWinRMFromStoringRunAsCredentials\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether the Windows Remote Management (WinRM) service will not allow RunAs credentials to be stored for any plug-ins.\",\"displayName\":\"Disallow WinRM from storing RunAs credentials\"}},\"DoNotAllowPasswordsToBeSaved\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether to prevent Remote Desktop Services - Terminal Services clients from saving passwords on a computer.\",\"displayName\":\"Do not allow passwords to be saved\"}},\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"SecuritySpecifyTheMaximumLogFileSizeKB\":{\"type\":\"String\",\"defaultValue\":\"196608\",\"metadata\":{\"description\":\"Specifies the maximum size for the Security event log in kilobytes.\",\"displayName\":\"Security: Specify the maximum log file size (KB)\"}},\"SendFileSamplesWhenFurtherAnalysisIsRequired\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether and how Windows Defender will submit samples of suspected malware  to Microsoft for further analysis when opt-in for MAPS telemetry is set.\",\"displayName\":\"Send file samples when further analysis is required\"}},\"SetClientConnectionEncryptionLevel\":{\"type\":\"String\",\"defaultValue\":\"3\",\"metadata\":{\"description\":\"Specifies whether to require the use of a specific encryption level to secure communications between client computers and RD Session Host servers during Remote Desktop Protocol (RDP) connections. This policy only applies when you are using native RDP encryption.\",\"displayName\":\"Set client connection encryption level\"}},\"SetTheDefaultBehaviorForAutoRun\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies the default behavior for Autorun commands. Autorun commands are generally stored in autorun.inf files. They often launch the installation program or other routines.\",\"displayName\":\"Set the default behavior for AutoRun\"}},\"SetupSpecifyTheMaximumLogFileSizeKB\":{\"type\":\"String\",\"defaultValue\":\"32768\",\"metadata\":{\"description\":\"Specifies the maximum size for the Setup event log in kilobytes.\",\"displayName\":\"Setup: Specify the maximum log file size (KB)\"}},\"SpecifyTheIntervalToCheckForDefinitionUpdates\":{\"type\":\"String\",\"defaultValue\":\"8\",\"metadata\":{\"description\":\"Specifies an interval at which to check for Windows Defender definition updates. The time value is represented as the number of hours between update checks.\",\"displayName\":\"Specify the interval to check for definition updates\"}},\"SystemSpecifyTheMaximumLogFileSizeKB\":{\"type\":\"String\",\"defaultValue\":\"32768\",\"metadata\":{\"description\":\"Specifies the maximum size for the System event log in kilobytes.\",\"displayName\":\"System: Specify the maximum log file size (KB)\"}},\"TurnOffDataExecutionPreventionForExplorer\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether to turn off Data Execution Prevention for Windows File Explorer. Disabling data execution prevention can allow certain legacy plug-in applications to function without terminating Explorer.\",\"displayName\":\"Turn off Data Execution Prevention for Explorer\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Send file samples when further analysis is required;ExpectedValue', '=', parameters('SendFileSamplesWhenFurtherAnalysisIsRequired'), ',', 'Allow indexing of encrypted files;ExpectedValue', '=', parameters('AllowIndexingOfEncryptedFiles'), ',', 'Allow Telemetry;ExpectedValue', '=', parameters('AllowTelemetry'), ',', 'Allow unencrypted traffic;ExpectedValue', '=', parameters('AllowUnencryptedTraffic'), ',', 'Always install with elevated privileges;ExpectedValue', '=', parameters('AlwaysInstallWithElevatedPrivileges'), ',', 'Always prompt for password upon connection;ExpectedValue', '=', parameters('AlwaysPromptForPasswordUponConnection'), ',', 'Application: Specify the maximum log file size (KB);ExpectedValue', '=', parameters('ApplicationSpecifyTheMaximumLogFileSizeKB'), ',', 'Automatically send memory dumps for OS-generated error reports;ExpectedValue', '=', parameters('AutomaticallySendMemoryDumpsForOSgeneratedErrorReports'), ',', 'Configure Default consent;ExpectedValue', '=', parameters('ConfigureDefaultConsent'), ',', 'Configure Windows SmartScreen;ExpectedValue', '=', parameters('ConfigureWindowsSmartScreen'), ',', 'Disallow Digest authentication;ExpectedValue', '=', parameters('DisallowDigestAuthentication'), ',', 'Disallow WinRM from storing RunAs credentials;ExpectedValue', '=', parameters('DisallowWinRMFromStoringRunAsCredentials'), ',', 'Do not allow passwords to be saved;ExpectedValue', '=', parameters('DoNotAllowPasswordsToBeSaved'), ',', 'Security: Specify the maximum log file size (KB);ExpectedValue', '=', parameters('SecuritySpecifyTheMaximumLogFileSizeKB'), ',', 'Set client connection encryption level;ExpectedValue', '=', parameters('SetClientConnectionEncryptionLevel'), ',', 'Set the default behavior for AutoRun;ExpectedValue', '=', parameters('SetTheDefaultBehaviorForAutoRun'), ',', 'Setup: Specify the maximum log file size (KB);ExpectedValue', '=', parameters('SetupSpecifyTheMaximumLogFileSizeKB'), ',', 'System: Specify the maximum log file size (KB);ExpectedValue', '=', parameters('SystemSpecifyTheMaximumLogFileSizeKB'), ',', 'Turn off Data Execution Prevention for Explorer;ExpectedValue', '=', parameters('TurnOffDataExecutionPreventionForExplorer'), ',', 'Specify the interval to check for definition updates;ExpectedValue', '=', parameters('SpecifyTheIntervalToCheckForDefinitionUpdates')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_WindowsComponents\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 33,
          "schema_version": 0,
          "attributes": {
            "description": "Windows machines should have the specified Group Policy settings in the category 'Windows Firewall Properties' for firewall state, connections, rule management, and notifications. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.",
            "display_name": "Windows machines should meet requirements for 'Windows Firewall Properties'",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/35d9882c-993d-44e6-87d2-db66ce21b636",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"configurationParameter\":{\"WindowsFirewallDomainAllowUnicastResponse\":\"Windows Firewall: Domain: Allow unicast response;ExpectedValue\",\"WindowsFirewallDomainApplyLocalConnectionSecurityRules\":\"Windows Firewall: Domain: Settings: Apply local connection security rules;ExpectedValue\",\"WindowsFirewallDomainApplyLocalFirewallRules\":\"Windows Firewall: Domain: Settings: Apply local firewall rules;ExpectedValue\",\"WindowsFirewallDomainBehaviorForOutboundConnections\":\"Windows Firewall: Domain: Outbound connections;ExpectedValue\",\"WindowsFirewallDomainDisplayNotifications\":\"Windows Firewall: Domain: Settings: Display a notification;ExpectedValue\",\"WindowsFirewallDomainUseProfileSettings\":\"Windows Firewall: Domain: Firewall state;ExpectedValue\",\"WindowsFirewallPrivateAllowUnicastResponse\":\"Windows Firewall: Private: Allow unicast response;ExpectedValue\",\"WindowsFirewallPrivateApplyLocalConnectionSecurityRules\":\"Windows Firewall: Private: Settings: Apply local connection security rules;ExpectedValue\",\"WindowsFirewallPrivateApplyLocalFirewallRules\":\"Windows Firewall: Private: Settings: Apply local firewall rules;ExpectedValue\",\"WindowsFirewallPrivateBehaviorForOutboundConnections\":\"Windows Firewall: Private: Outbound connections;ExpectedValue\",\"WindowsFirewallPrivateDisplayNotifications\":\"Windows Firewall: Private: Settings: Display a notification;ExpectedValue\",\"WindowsFirewallPrivateUseProfileSettings\":\"Windows Firewall: Private: Firewall state;ExpectedValue\",\"WindowsFirewallPublicAllowUnicastResponse\":\"Windows Firewall: Public: Allow unicast response;ExpectedValue\",\"WindowsFirewallPublicApplyLocalConnectionSecurityRules\":\"Windows Firewall: Public: Settings: Apply local connection security rules;ExpectedValue\",\"WindowsFirewallPublicApplyLocalFirewallRules\":\"Windows Firewall: Public: Settings: Apply local firewall rules;ExpectedValue\",\"WindowsFirewallPublicBehaviorForOutboundConnections\":\"Windows Firewall: Public: Outbound connections;ExpectedValue\",\"WindowsFirewallPublicDisplayNotifications\":\"Windows Firewall: Public: Settings: Display a notification;ExpectedValue\",\"WindowsFirewallPublicUseProfileSettings\":\"Windows Firewall: Public: Firewall state;ExpectedValue\"},\"name\":\"AzureBaseline_WindowsFirewallProperties\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "35d9882c-993d-44e6-87d2-db66ce21b636",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"WindowsFirewallDomainAllowUnicastResponse\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Domain profile.\",\"displayName\":\"Windows Firewall: Domain: Allow unicast response\"}},\"WindowsFirewallDomainApplyLocalConnectionSecurityRules\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Domain profile.\",\"displayName\":\"Windows Firewall (Domain): Apply local connection security rules\"}},\"WindowsFirewallDomainApplyLocalFirewallRules\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Domain profile.\",\"displayName\":\"Windows Firewall (Domain): Apply local firewall rules\"}},\"WindowsFirewallDomainBehaviorForOutboundConnections\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies the behavior for outbound connections for the Domain profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\",\"displayName\":\"Windows Firewall (Domain): Behavior for outbound connections\"}},\"WindowsFirewallDomainDisplayNotifications\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Domain profile.\",\"displayName\":\"Windows Firewall (Domain): Display notifications\"}},\"WindowsFirewallDomainUseProfileSettings\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security uses the settings for the Domain profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\",\"displayName\":\"Windows Firewall (Domain): Use profile settings\"}},\"WindowsFirewallPrivateAllowUnicastResponse\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Private profile.\",\"displayName\":\"Windows Firewall: Private: Allow unicast response\"}},\"WindowsFirewallPrivateApplyLocalConnectionSecurityRules\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Private profile.\",\"displayName\":\"Windows Firewall (Private): Apply local connection security rules\"}},\"WindowsFirewallPrivateApplyLocalFirewallRules\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Private profile.\",\"displayName\":\"Windows Firewall (Private): Apply local firewall rules\"}},\"WindowsFirewallPrivateBehaviorForOutboundConnections\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies the behavior for outbound connections for the Private profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\",\"displayName\":\"Windows Firewall (Private): Behavior for outbound connections\"}},\"WindowsFirewallPrivateDisplayNotifications\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Private profile.\",\"displayName\":\"Windows Firewall (Private): Display notifications\"}},\"WindowsFirewallPrivateUseProfileSettings\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security uses the settings for the Private profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\",\"displayName\":\"Windows Firewall (Private): Use profile settings\"}},\"WindowsFirewallPublicAllowUnicastResponse\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Public profile.\",\"displayName\":\"Windows Firewall: Public: Allow unicast response\"}},\"WindowsFirewallPublicApplyLocalConnectionSecurityRules\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Public profile.\",\"displayName\":\"Windows Firewall (Public): Apply local connection security rules\"}},\"WindowsFirewallPublicApplyLocalFirewallRules\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Public profile.\",\"displayName\":\"Windows Firewall (Public): Apply local firewall rules\"}},\"WindowsFirewallPublicBehaviorForOutboundConnections\":{\"type\":\"String\",\"defaultValue\":\"0\",\"metadata\":{\"description\":\"Specifies the behavior for outbound connections for the Public profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\",\"displayName\":\"Windows Firewall (Public): Behavior for outbound connections\"}},\"WindowsFirewallPublicDisplayNotifications\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Public profile.\",\"displayName\":\"Windows Firewall (Public): Display notifications\"}},\"WindowsFirewallPublicUseProfileSettings\":{\"type\":\"String\",\"defaultValue\":\"1\",\"metadata\":{\"description\":\"Specifies whether Windows Firewall with Advanced Security uses the settings for the Public profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\",\"displayName\":\"Windows Firewall (Public): Use profile settings\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},{\"equals\":\"[base64(concat('Windows Firewall: Domain: Firewall state;ExpectedValue', '=', parameters('WindowsFirewallDomainUseProfileSettings'), ',', 'Windows Firewall: Domain: Outbound connections;ExpectedValue', '=', parameters('WindowsFirewallDomainBehaviorForOutboundConnections'), ',', 'Windows Firewall: Domain: Settings: Apply local connection security rules;ExpectedValue', '=', parameters('WindowsFirewallDomainApplyLocalConnectionSecurityRules'), ',', 'Windows Firewall: Domain: Settings: Apply local firewall rules;ExpectedValue', '=', parameters('WindowsFirewallDomainApplyLocalFirewallRules'), ',', 'Windows Firewall: Domain: Settings: Display a notification;ExpectedValue', '=', parameters('WindowsFirewallDomainDisplayNotifications'), ',', 'Windows Firewall: Private: Firewall state;ExpectedValue', '=', parameters('WindowsFirewallPrivateUseProfileSettings'), ',', 'Windows Firewall: Private: Outbound connections;ExpectedValue', '=', parameters('WindowsFirewallPrivateBehaviorForOutboundConnections'), ',', 'Windows Firewall: Private: Settings: Apply local connection security rules;ExpectedValue', '=', parameters('WindowsFirewallPrivateApplyLocalConnectionSecurityRules'), ',', 'Windows Firewall: Private: Settings: Apply local firewall rules;ExpectedValue', '=', parameters('WindowsFirewallPrivateApplyLocalFirewallRules'), ',', 'Windows Firewall: Private: Settings: Display a notification;ExpectedValue', '=', parameters('WindowsFirewallPrivateDisplayNotifications'), ',', 'Windows Firewall: Public: Firewall state;ExpectedValue', '=', parameters('WindowsFirewallPublicUseProfileSettings'), ',', 'Windows Firewall: Public: Outbound connections;ExpectedValue', '=', parameters('WindowsFirewallPublicBehaviorForOutboundConnections'), ',', 'Windows Firewall: Public: Settings: Apply local connection security rules;ExpectedValue', '=', parameters('WindowsFirewallPublicApplyLocalConnectionSecurityRules'), ',', 'Windows Firewall: Public: Settings: Apply local firewall rules;ExpectedValue', '=', parameters('WindowsFirewallPublicApplyLocalFirewallRules'), ',', 'Windows Firewall: Public: Settings: Display a notification;ExpectedValue', '=', parameters('WindowsFirewallPublicDisplayNotifications'), ',', 'Windows Firewall: Domain: Allow unicast response;ExpectedValue', '=', parameters('WindowsFirewallDomainAllowUnicastResponse'), ',', 'Windows Firewall: Private: Allow unicast response;ExpectedValue', '=', parameters('WindowsFirewallPrivateAllowUnicastResponse'), ',', 'Windows Firewall: Public: Allow unicast response;ExpectedValue', '=', parameters('WindowsFirewallPublicAllowUnicastResponse')))]\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\"}]},\"name\":\"AzureBaseline_WindowsFirewallProperties\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 34,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have a maximum password age of 70 days",
            "display_name": "Audit Windows machines that do not have a maximum password age of 70 days",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4ceb8dc2-559c-478b-a15b-733fbf1e3738",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"MaximumPasswordAge\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "name": "4ceb8dc2-559c-478b-a15b-733fbf1e3738",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"MaximumPasswordAge\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 35,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have a minimum password age of 1 day",
            "display_name": "Audit Windows machines that do not have a minimum password age of 1 day",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/237b38db-ca4d-4259-9e47-7882441ca2c0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"MinimumPasswordAge\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "name": "237b38db-ca4d-4259-9e47-7882441ca2c0",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"MinimumPasswordAge\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 36,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have the password complexity setting enabled",
            "display_name": "Audit Windows machines that do not have the password complexity setting enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bf16e0bb-31e1-4646-8202-60a235cc7e74",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"PasswordMustMeetComplexityRequirements\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "name": "bf16e0bb-31e1-4646-8202-60a235cc7e74",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"PasswordMustMeetComplexityRequirements\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 37,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not store passwords using reversible encryption",
            "display_name": "Audit Windows machines that do not store passwords using reversible encryption",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/da0f98fe-a24b-4ad5-af69-bd0400233661",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"StorePasswordsUsingReversibleEncryption\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "name": "da0f98fe-a24b-4ad5-af69-bd0400233661",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"StorePasswordsUsingReversibleEncryption\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 38,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that allow re-use of the previous 24 passwords",
            "display_name": "Audit Windows machines that allow re-use of the previous 24 passwords",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5b054a0d-39e2-4d53-bea3-9734cad2c69b",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"EnforcePasswordHistory\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "name": "5b054a0d-39e2-4d53-bea3-9734cad2c69b",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"EnforcePasswordHistory\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 39,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not restrict the minimum password length to 14 characters",
            "display_name": "Audit Windows machines that do not restrict the minimum password length to 14 characters",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a2d0e922-65d0-40c4-8f87-ea6da2d307a2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"MinimumPasswordLength\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "name": "a2d0e922-65d0-40c4-8f87-ea6da2d307a2",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"esri\",\"incredibuild\",\"MicrosoftDynamicsAX\",\"MicrosoftSharepoint\",\"MicrosoftVisualStudio\",\"MicrosoftWindowsDesktop\",\"MicrosoftWindowsServerHPCPack\"]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"standard-data-science-vm\",\"windows-data-science-vm\"]}]},{\"allOf\":[{\"equals\":\"batch\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"rendering-windows2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"cis-windows-server-201*\"}]},{\"allOf\":[{\"equals\":\"pivotal\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"bosh-windows-server*\"}]},{\"allOf\":[{\"equals\":\"cloud-infrastructure-services\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"ad*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Windows*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imageSKU\"},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"2008*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"SQL2008*\"}]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"windows*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"MinimumPasswordLength\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 40,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Linux machines that allow remote connections from accounts without passwords",
            "display_name": "Audit Linux machines that allow remote connections from accounts without passwords",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ea53dbee-c6c9-4f0e-9f9e-de0039b78023",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"PasswordPolicy_msid110\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "ea53dbee-c6c9-4f0e-9f9e-de0039b78023",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-windows*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"linux*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"PasswordPolicy_msid110\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 41,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Linux machines that do not have the passwd file permissions set to 0644",
            "display_name": "Audit Linux machines that do not have the passwd file permissions set to 0644",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e6955644-301c-44b5-a4c4-528577de6861",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"PasswordPolicy_msid121\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "e6955644-301c-44b5-a4c4-528577de6861",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-windows*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"linux*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"PasswordPolicy_msid121\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 42,
          "schema_version": 0,
          "attributes": {
            "description": "Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Linux machines that have accounts without passwords",
            "display_name": "Audit Linux machines that have accounts without passwords",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f6ec09a3-78bf-4f8f-99dc-6c77182d0f99",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"PasswordPolicy_msid232\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"3.0.0\"}",
            "name": "f6ec09a3-78bf-4f8f-99dc-6c77182d0f99",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imagePublisher\",\"in\":[\"microsoft-aks\",\"qubole-inc\",\"datastax\",\"couchbase\",\"scalegrid\",\"checkpoint\",\"paloaltonetworks\",\"debian\",\"credativ\"]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"center-for-internet-security-inc\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"cis-windows*\"}]},{\"allOf\":[{\"equals\":\"Suse\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"11*\"}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"12*\"}]},{\"allOf\":[{\"equals\":\"microsoft-dsvm\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"notLike\":\"dsvm-win*\"}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"notLike\":\"6*\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"anyOf\":[{\"exists\":\"true\",\"field\":\"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\"},{\"field\":\"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\"like\":\"Linux*\"}]},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notIn\":[\"OpenLogic\",\"RedHat\",\"credativ\",\"Suse\",\"Canonical\",\"microsoft-dsvm\",\"cloudera\",\"microsoft-ads\",\"center-for-internet-security-inc\",\"Oracle\",\"AzureDatabricks\",\"azureopenshift\"]}]}]}]}]},{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"linux*\"}]},{\"allOf\":[{\"equals\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines\",\"field\":\"type\"},{\"field\":\"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\"like\":\"linux*\"}]}]}]}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"PasswordPolicy_msid232\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 43,
          "schema_version": 0,
          "attributes": {
            "description": "This policy audits any Windows/Linux virtual machines (VMs) if the Log Analytics agent is not installed which Security Center uses to monitor for security vulnerabilities and threats",
            "display_name": "Log Analytics agent should be installed on your virtual machine for Azure Security Center monitoring",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a4fe33eb-e377-4efb-ab31-0784311bc499",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "a4fe33eb-e377-4efb-ab31-0784311bc499",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.ClassicCompute/virtualMachines\",\"Microsoft.Compute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"d1db3318-01ff-16de-29eb-28b344515626\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 44,
          "schema_version": 0,
          "attributes": {
            "description": "To monitor for security vulnerabilities and threats, Azure Security Center collects data from your Azure virtual machines. Data is collected by the Log Analytics agent, formerly known as the Microsoft Monitoring Agent (MMA), which reads various security-related configurations and event logs from the machine and copies the data to your Log Analytics workspace for analysis. We recommend enabling auto provisioning to automatically deploy the agent to all supported Azure VMs and any new ones that are created.",
            "display_name": "Auto provisioning of the Log Analytics agent should be enabled on your subscription",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/475aae12-b88a-4572-8b36-9b712b2b3a17",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "475aae12-b88a-4572-8b36-9b712b2b3a17",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"On\",\"field\":\"Microsoft.Security/autoProvisioningSettings/autoProvision\"},\"type\":\"Microsoft.Security/autoProvisioningSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 45,
          "schema_version": 0,
          "attributes": {
            "description": "Machines are non-compliant if Log Analytics agent is not installed on Azure Arc enabled Linux server.",
            "display_name": "Linux machines should have Log Analytics agent installed on Azure Arc",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1e7fed80-8321-4605-b42c-65fc300f23a3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"LinuxLogAnalyticsAgentInstalled\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"1.1.0\"}",
            "name": "1e7fed80-8321-4605-b42c-65fc300f23a3",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"linux*\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"LinuxLogAnalyticsAgentInstalled\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 46,
          "schema_version": 0,
          "attributes": {
            "description": "Machines are non-compliant if Log Analytics agent is not installed on Azure Arc enabled windows server.",
            "display_name": "Windows machines should have Log Analytics agent installed on Azure Arc",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4078e558-bda6-41fb-9b3c-361e8875200d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Guest Configuration\",\"guestConfiguration\":{\"name\":\"WindowsLogAnalyticsAgentInstalled\",\"version\":\"1.*\"},\"requiredProviders\":[\"Microsoft.GuestConfiguration\"],\"version\":\"2.0.0\"}",
            "name": "4078e558-bda6-41fb-9b3c-361e8875200d",
            "parameters": "{\"IncludeArcMachines\":{\"type\":\"String\",\"allowedValues\":[\"true\",\"false\"],\"defaultValue\":\"false\",\"metadata\":{\"description\":\"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\"displayName\":\"Include Arc connected servers\",\"portalReview\":\"true\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of this policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"true\",\"value\":\"[parameters('IncludeArcMachines')]\"},{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"windows*\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Compliant\",\"field\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\"},\"name\":\"WindowsLogAnalyticsAgentInstalled\",\"type\":\"Microsoft.GuestConfiguration/guestConfigurationAssignments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 47,
          "schema_version": 0,
          "attributes": {
            "description": "This policy audits Linux Azure Arc machines if the Log Analytics extension is not installed.",
            "display_name": "[Preview]: Log Analytics extension should be installed on your Linux Azure Arc machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/842c54e8-c2f9-4d79-ae8d-38d8b8019373",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"1.0.1-preview\"}",
            "name": "842c54e8-c2f9-4d79-ae8d-38d8b8019373",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"field\":\"Microsoft.HybridCompute/imageOffer\",\"like\":\"linux*\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 48,
          "schema_version": 0,
          "attributes": {
            "description": "Automate the deployment of Azure Monitor Agent extension on your Linux Arc-enabled machines for collecting telemetry data from the guest OS. This policy will install the extension if the region is supported. Learn more: https://aka.ms/AMAOverview.",
            "display_name": "Configure Linux Arc-enabled machines to run Azure Monitor Agent",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/845857af-0333-4c5d-bbbc-6076697da122",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.0\"}",
            "name": "845857af-0333-4c5d-bbbc-6076697da122",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"},{\"field\":\"location\",\"in\":[\"australiacentral\",\"australiaeast\",\"australiasoutheast\",\"brazilsouth\",\"canadacentral\",\"canadaeast\",\"centralindia\",\"centralus\",\"eastasia\",\"eastus2euap\",\"eastus\",\"eastus2\",\"francecentral\",\"germanywestcentral\",\"japaneast\",\"japanwest\",\"jioindiawest\",\"koreacentral\",\"koreasouth\",\"northcentralus\",\"northeurope\",\"norwayeast\",\"southafricanorth\",\"southcentralus\",\"southeastasia\",\"southindia\",\"switzerlandnorth\",\"uaenorth\",\"uksouth\",\"ukwest\",\"westcentralus\",\"westeurope\",\"westindia\",\"westus\",\"westus2\"]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-05-20\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('extensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"enableAutomaticUpgrade\":true,\"publisher\":\"[variables('extensionPublisher')]\",\"type\":\"[variables('extensionType')]\",\"typeHandlerVersion\":\"[variables('extensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"extensionName\":\"AzureMonitorLinuxAgent\",\"extensionPublisher\":\"Microsoft.Azure.Monitor\",\"extensionType\":\"AzureMonitorLinuxAgent\",\"extensionTypeHandlerVersion\":\"1.21\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureMonitorLinuxAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitor\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/cd570a14-e51a-42ad-bac8-bafd67325302\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/cd570a14-e51a-42ad-bac8-bafd67325302"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 49,
          "schema_version": 0,
          "attributes": {
            "description": "Protect your Azure Arc-enabled Linux machines with Microsoft Defender for Cloud capabilities, by installing Log Analytics agents that send data to a default Log Analytics workspace created by Microsoft Defender for Cloud.",
            "display_name": "[Preview]: Configure Azure Arc-enabled Linux machines with Log Analytics agents connected to default Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bacd7fca-1938-443d-aad6-a786107b1bfb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "name": "bacd7fca-1938-443d-aad6-a786107b1bfb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"eastus\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"vmResourceGroup\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"vmResourceGroup\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[variables('defaultRGLocation')]\",\"name\":\"[variables('defaultRGName')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2020-06-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', variables('defaultRGName'))]\"],\"name\":\"[variables('deployDefaultAscResourceGroup')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"defaultRGLocation\":{\"value\":\"[variables('defaultRGLocation')]\"},\"workspaceName\":{\"value\":\"[variables('workspaceName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"defaultRGLocation\":{\"type\":\"string\"},\"workspaceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2015-11-01-preview\",\"location\":\"[parameters('defaultRGLocation')]\",\"name\":\"[parameters('workspaceName')]\",\"properties\":{\"features\":{\"searchVersion\":1},\"retentionInDays\":30,\"sku\":{\"name\":\"pernode\"}},\"type\":\"Microsoft.OperationalInsights/workspaces\"},{\"apiVersion\":\"2015-11-01-preview\",\"dependsOn\":[\"[parameters('workspaceName')]\"],\"location\":\"[parameters('defaultRGLocation')]\",\"name\":\"[variables('securityCenterFreeSolution').Name]\",\"plan\":{\"name\":\"[variables('securityCenterFreeSolution').Name]\",\"product\":\"[Concat('OMSGallery/', variables('securityCenterFreeSolution').GalleryName)]\",\"promotionCode\":\"\",\"publisher\":\"Microsoft\"},\"properties\":{\"workspaceResourceId\":\"[resourceId('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]\"},\"type\":\"Microsoft.OperationsManagement/solutions\"}],\"variables\":{\"securityCenterFreeSolution\":{\"GalleryName\":\"SecurityCenterFree\",\"Name\":\"[Concat('SecurityCenterFree', '(', parameters('workspaceName'), ')')]\"}}}},\"resourceGroup\":\"[variables('defaultRGName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"dependsOn\":[\"[variables('deployDefaultAscResourceGroup')]\"],\"name\":\"[variables('deployExtension')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[parameters('location')]\"},\"vmName\":{\"value\":\"[parameters('vmName')]\"},\"workspaceId\":{\"value\":\"[concat(subscription().id,'/resourceGroups/', variables('defaultRGName'), '/providers/Microsoft.OperationalInsights/workspaces/', variables('workspaceName'))]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"workspaceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('workspaceId'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('workspaceId'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\"}}},\"resourceGroup\":\"[parameters('vmResourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"defaultRGLocation\":\"[parameters('location')]\",\"defaultRGName\":\"[concat('DefaultResourceGroup-', variables('locationCode'))]\",\"deployDefaultAscResourceGroup\":\"[concat('deployDefaultAscResourceGroup-', uniqueString(deployment().name))]\",\"deployExtension\":\"[concat('deployExtension-', uniqueString(deployment().name))]\",\"isContainLocation\":\"[contains(variables('locationLongNameToShortMap'),parameters('location'))]\",\"locationCode\":\"[if(lessOrEquals(length(variables('selectedLocation')),8),variables('selectedLocation'),concat(substring(variables('selectedLocation'),0,6),substring(variables('selectedLocation'),sub(length(variables('selectedLocation')),2),2)))]\",\"locationLongNameToShortMap\":{\"australiacentral\":\"CAU\",\"australiaeast\":\"EAU\",\"australiasoutheast\":\"SEAU\",\"brazilsouth\":\"CQ\",\"canadacentral\":\"CCA\",\"centralindia\":\"CIN\",\"centralus\":\"CUS\",\"eastasia\":\"EA\",\"eastus\":\"EUS\",\"eastus2\":\"EUS2\",\"eastus2euap\":\"eus2p\",\"francecentral\":\"PAR\",\"germanywestcentral\":\"DEWC\",\"japaneast\":\"EJP\",\"koreacentral\":\"SE\",\"northcentralus\":\"NCUS\",\"northeurope\":\"NEU\",\"norwayeast\":\"NOE\",\"southafricanorth\":\"JNB\",\"southcentralus\":\"SCUS\",\"southeastasia\":\"SEA\",\"swedencentral\":\"SEC\",\"switzerlandnorth\":\"CHN\",\"switzerlandwest\":\"CHW\",\"uaenorth\":\"DXB\",\"uksouth\":\"SUK\",\"ukwest\":\"WUK\",\"westcentralus\":\"WCUS\",\"westeurope\":\"WEU\",\"westus\":\"WUS\",\"westus2\":\"WUS2\"},\"selectedLocation\":\"[if(variables('isContainLocation'),variables('locationLongNameToShortMap')[parameters('location')],parameters('location'))]\",\"subscriptionId\":\"[subscription().subscriptionId]\",\"workspaceName\":\"[concat('DefaultWorkspace-', variables('subscriptionId'),'-', variables('locationCode'))]\"}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": 50,
          "schema_version": 0,
          "attributes": {
            "description": "Protect your Azure Arc-enabled Windows machines with Microsoft Defender for Cloud capabilities, by installing Log Analytics agents that send data to a default Log Analytics workspace created by Microsoft Defender for Cloud.",
            "display_name": "[Preview]: Configure Azure Arc-enabled Windows machines with Log Analytics agents connected to default Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/594c1276-f44f-482d-9910-71fac2ce5ae0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"1.1.0-preview\"}",
            "name": "594c1276-f44f-482d-9910-71fac2ce5ae0",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"eastus\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"vmResourceGroup\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"vmResourceGroup\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[variables('defaultRGLocation')]\",\"name\":\"[variables('defaultRGName')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2020-06-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups', variables('defaultRGName'))]\"],\"name\":\"[variables('deployDefaultAscResourceGroup')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"defaultRGLocation\":{\"value\":\"[variables('defaultRGLocation')]\"},\"workspaceName\":{\"value\":\"[variables('workspaceName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"defaultRGLocation\":{\"type\":\"string\"},\"workspaceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2015-11-01-preview\",\"location\":\"[parameters('defaultRGLocation')]\",\"name\":\"[parameters('workspaceName')]\",\"properties\":{\"features\":{\"searchVersion\":1},\"retentionInDays\":30,\"sku\":{\"name\":\"pernode\"}},\"type\":\"Microsoft.OperationalInsights/workspaces\"},{\"apiVersion\":\"2015-11-01-preview\",\"dependsOn\":[\"[parameters('workspaceName')]\"],\"location\":\"[parameters('defaultRGLocation')]\",\"name\":\"[variables('securityCenterFreeSolution').Name]\",\"plan\":{\"name\":\"[variables('securityCenterFreeSolution').Name]\",\"product\":\"[Concat('OMSGallery/', variables('securityCenterFreeSolution').GalleryName)]\",\"promotionCode\":\"\",\"publisher\":\"Microsoft\"},\"properties\":{\"workspaceResourceId\":\"[resourceId('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]\"},\"type\":\"Microsoft.OperationsManagement/solutions\"}],\"variables\":{\"securityCenterFreeSolution\":{\"GalleryName\":\"SecurityCenterFree\",\"Name\":\"[Concat('SecurityCenterFree', '(', parameters('workspaceName'), ')')]\"}}}},\"resourceGroup\":\"[variables('defaultRGName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"dependsOn\":[\"[variables('deployDefaultAscResourceGroup')]\"],\"name\":\"[variables('deployExtension')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[parameters('location')]\"},\"vmName\":{\"value\":\"[parameters('vmName')]\"},\"workspaceId\":{\"value\":\"[concat(subscription().id,'/resourceGroups/', variables('defaultRGName'), '/providers/Microsoft.OperationalInsights/workspaces/', variables('workspaceName'))]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"},\"workspaceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('workspaceId'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('workspaceId'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}},\"resourceGroup\":\"[parameters('vmResourceGroup')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"defaultRGLocation\":\"[parameters('location')]\",\"defaultRGName\":\"[concat('DefaultResourceGroup-', variables('locationCode'))]\",\"deployDefaultAscResourceGroup\":\"[concat('deployDefaultAscResourceGroup-', uniqueString(deployment().name))]\",\"deployExtension\":\"[concat('deployExtension-', uniqueString(deployment().name))]\",\"isContainLocation\":\"[contains(variables('locationLongNameToShortMap'),parameters('location'))]\",\"locationCode\":\"[if(lessOrEquals(length(variables('selectedLocation')),8),variables('selectedLocation'),concat(substring(variables('selectedLocation'),0,6),substring(variables('selectedLocation'),sub(length(variables('selectedLocation')),2),2)))]\",\"locationLongNameToShortMap\":{\"australiacentral\":\"CAU\",\"australiaeast\":\"EAU\",\"australiasoutheast\":\"SEAU\",\"brazilsouth\":\"CQ\",\"canadacentral\":\"CCA\",\"centralindia\":\"CIN\",\"centralus\":\"CUS\",\"eastasia\":\"EA\",\"eastus\":\"EUS\",\"eastus2\":\"EUS2\",\"eastus2euap\":\"eus2p\",\"francecentral\":\"PAR\",\"germanywestcentral\":\"DEWC\",\"japaneast\":\"EJP\",\"koreacentral\":\"SE\",\"northcentralus\":\"NCUS\",\"northeurope\":\"NEU\",\"norwayeast\":\"NOE\",\"southafricanorth\":\"JNB\",\"southcentralus\":\"SCUS\",\"southeastasia\":\"SEA\",\"swedencentral\":\"SEC\",\"switzerlandnorth\":\"CHN\",\"switzerlandwest\":\"CHW\",\"uaenorth\":\"DXB\",\"uksouth\":\"SUK\",\"ukwest\":\"WUK\",\"westcentralus\":\"WCUS\",\"westeurope\":\"WEU\",\"westus\":\"WUS\",\"westus2\":\"WUS2\"},\"selectedLocation\":\"[if(variables('isContainLocation'),variables('locationLongNameToShortMap')[parameters('location')],parameters('location'))]\",\"subscriptionId\":\"[subscription().subscriptionId]\",\"workspaceName\":\"[concat('DefaultWorkspace-', variables('subscriptionId'),'-', variables('locationCode'))]\"}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.policyset_definitions",
      "mode": "managed",
      "type": "azurerm_policy_set_definition",
      "name": "guest_configuration",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "Contains common Guest Configuration policies",
            "display_name": "Guest Configuration",
            "id": "/subscriptions/19a7ed62-f51f-4e53-b3ea-6ba9a63f17fe/providers/Microsoft.Authorization/policySetDefinitions/guest_configuration",
            "management_group_id": "",
            "metadata": "{\"category\":\"Custom\",\"createdBy\":\"355c85c8-2bd0-4fde-9250-76aa4dd16b11\",\"createdOn\":\"2022-12-01T09:11:00.055557Z\",\"updatedBy\":\"355c85c8-2bd0-4fde-9250-76aa4dd16b11\",\"updatedOn\":\"2022-12-06T07:11:18.2178161Z\"}",
            "name": "guest_configuration",
            "parameters": null,
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e",
                "policy_group_names": [],
                "reference_id": "Add system-assigned managed identity to enable Guest Configuration assignments on virtual machines with no identities"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/497dff13-db2a-4c0f-8603-28fa3b331ab6",
                "policy_group_names": [],
                "reference_id": "Add system-assigned managed identity to enable Guest Configuration assignments on VMs with a user-assigned identity"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6",
                "policy_group_names": [],
                "reference_id": "Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da",
                "policy_group_names": [],
                "reference_id": "Deploy the Linux Guest Configuration extension to enable Guest Configuration assignments on Linux VMs"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f40c7c00-b4e3-4068-a315-5fe81347a904",
                "policy_group_names": [],
                "reference_id": "[Preview]: Add user-assigned managed identity to enable Guest Configuration assignments on virtual machines"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3aa2661b-02d7-4ba6-99bc-dc36b10489fd",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Administrative Templates - Control Panel'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/67e010c1-640d-438e-a3a5-feaccb533a98",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Administrative Templates - Network'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/968410dc-5ca0-4518-8a5b-7b55f0530ea9",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Administrative Templates - System'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e0a7e899-2ce2-4253-8a13-d808fdeb75af",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Administrative Templates - MSS (Legacy)'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee984370-154a-4ee8-9726-19d900e56fc0",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Accounts'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/33936777-f2ac-45aa-82ec-07958ec9ade4",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Audit'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8794ff4f-1a35-4e18-938f-0b22055067cd",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Devices'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d472d2c9-d6a3-4500-9f5f-b15f123005aa",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Interactive Logon'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d6c69680-54f0-4349-af10-94dd05f4225e",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Microsoft Network Client'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/caf2d518-f029-4f6b-833b-d7081702f253",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Microsoft Network Server'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3ff60f98-7fa4-410a-9f7f-0b00f5afdbdd",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Network Access'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1221c620-d201-468c-81e7-2817e6107e84",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Network Security'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f71be03e-e25b-4d0f-b8bc-9b3e309b66c0",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Recovery console'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b4a4d1eb-0263-441b-84cb-a44073d8372d",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - Shutdown'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2f262ace-812a-4fd0-b731-b38ba9e9708d",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - System objects'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/12017595-5a75-4bb1-9d97-4c2c939ea3c3",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - System settings'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/492a29ed-d143-4f03-b6a4-705ce081b463",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Options - User Account Control'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f2143251-70de-4e81-87a8-36cee5a2f29d",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Security Settings - Account Policies'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/43bb60fe-1d7e-4b82-9e93-496bfc99e7d5",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'System Audit Policies - Account Logon'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94d9aca8-3757-46df-aa51-f218c5f11954",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'System Audit Policies - Account Management'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/58383b73-94a9-4414-b382-4146eb02611b",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'System Audit Policies - Detailed Tracking'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/19be9779-c776-4dfa-8a15-a2fd5dc843d6",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'System Audit Policies - Logon-Logoff'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/35781875-8026-4628-b19b-f6efb4d88a1d",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'System Audit Policies - Object Access'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2a7a701e-dff3-4da9-9ec5-42cb98594c0b",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'System Audit Policies - Policy Change'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/87845465-c458-45f3-af66-dcd62176f397",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'System Audit Policies - Privilege Use'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8316fa92-d69c-4810-8124-62414f560dcf",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'System Audit Policies - System'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e068b215-0026-4354-b347-8fb2766f73a2",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'User Rights Assignment'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8537fe96-8cbe-43de-b0ef-131bc72bc22a",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Windows Components'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/35d9882c-993d-44e6-87d2-db66ce21b636",
                "policy_group_names": [],
                "reference_id": "Windows machines should meet requirements for 'Windows Firewall Properties'"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4ceb8dc2-559c-478b-a15b-733fbf1e3738",
                "policy_group_names": [],
                "reference_id": "Audit Windows machines that do not have a maximum password age of 70 days"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/237b38db-ca4d-4259-9e47-7882441ca2c0",
                "policy_group_names": [],
                "reference_id": "Audit Windows machines that do not have a minimum password age of 1 day"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bf16e0bb-31e1-4646-8202-60a235cc7e74",
                "policy_group_names": [],
                "reference_id": "Audit Windows machines that do not have the password complexity setting enabled"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/da0f98fe-a24b-4ad5-af69-bd0400233661",
                "policy_group_names": [],
                "reference_id": "Audit Windows machines that do not store passwords using reversible encryption"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5b054a0d-39e2-4d53-bea3-9734cad2c69b",
                "policy_group_names": [],
                "reference_id": "Audit Windows machines that allow re-use of the previous 24 passwords"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a2d0e922-65d0-40c4-8f87-ea6da2d307a2",
                "policy_group_names": [],
                "reference_id": "Audit Windows machines that do not restrict the minimum password length to 14 characters"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ea53dbee-c6c9-4f0e-9f9e-de0039b78023",
                "policy_group_names": [],
                "reference_id": "Audit Linux machines that allow remote connections from accounts without passwords"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e6955644-301c-44b5-a4c4-528577de6861",
                "policy_group_names": [],
                "reference_id": "Audit Linux machines that do not have the passwd file permissions set to 0644"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f6ec09a3-78bf-4f8f-99dc-6c77182d0f99",
                "policy_group_names": [],
                "reference_id": "Audit Linux machines that have accounts without passwords"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a4fe33eb-e377-4efb-ab31-0784311bc499",
                "policy_group_names": [],
                "reference_id": "Log Analytics agent should be installed on your virtual machine for Azure Security Center monitoring"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/475aae12-b88a-4572-8b36-9b712b2b3a17",
                "policy_group_names": [],
                "reference_id": "Auto provisioning of the Log Analytics agent should be enabled on your subscription"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1e7fed80-8321-4605-b42c-65fc300f23a3",
                "policy_group_names": [],
                "reference_id": "Linux machines should have Log Analytics agent installed on Azure Arc"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4078e558-bda6-41fb-9b3c-361e8875200d",
                "policy_group_names": [],
                "reference_id": "Windows machines should have Log Analytics agent installed on Azure Arc"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/842c54e8-c2f9-4d79-ae8d-38d8b8019373",
                "policy_group_names": null,
                "reference_id": "[Preview]: Log Analytics extension should be installed on your Linux Azure Arc machines"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/845857af-0333-4c5d-bbbc-6076697da122",
                "policy_group_names": null,
                "reference_id": "Configure Linux Arc-enabled machines to run Azure Monitor Agent"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bacd7fca-1938-443d-aad6-a786107b1bfb",
                "policy_group_names": null,
                "reference_id": "[Preview]: Configure Azure Arc-enabled Linux machines with Log Analytics agents connected to default Log Analytics workspace"
              },
              {
                "parameter_values": "",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/594c1276-f44f-482d-9910-71fac2ce5ae0",
                "policy_group_names": null,
                "reference_id": "[Preview]: Configure Azure Arc-enabled Windows machines with Log Analytics agents connected to default Log Analytics workspace"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "module.policyset_definitions.data.azurerm_policy_definition.builtin_policies_guest_configuration"
          ]
        }
      ]
    }
  ]
}
